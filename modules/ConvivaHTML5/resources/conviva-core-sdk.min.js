/*! (C) 2015 Conviva, Inc. All rights reserved. Confidential and proprietary. */
var Conviva=Conviva||{};!function(){"use strict";if("undefined"==typeof Conviva.PrivateLoader){var a=Conviva.PrivateLoader={};!function(){var b=a.Client=function(a,f){function h(a,b){if(!(a instanceof c))throw new Error("clientSettings parameter should be an instance of ClientSettings.");
    if(!(b instanceof e))throw new Error("systemFactory parameter should be an instance of SystemFactory.");this._settings=a,this._settings.sanitize(),this._systemFactory=b,this._systemFactory.configure("SDK",this._settings),
        this._exceptionCatcher=this._systemFactory.buildExceptionCatcher(),this._exceptionCatcher.runProtected("Client.init",function(){i._id=J.uinteger32(),i._logger=i._systemFactory.buildLogger(),i._logger.setModuleName("Client"),
        i._logger.info("init(): url="+i._settings.gatewayUrl+" customerKey="+i._settings.customerKey),i._config=i._systemFactory.buildConfig(),i._config.load(),i._sessionFactory=i._systemFactory.buildSessionFactory(i,i._settings,i._config),
        i._logger.info("init(): done.")},function(a){throw new Error("Client constructor failed.")})}var i=this;this._logger=null,this._sessionFactory=null,this._systemFactory=null,this._globalSessionKey=-1,this._settings=null,
    this._systemSettings=null,this._exceptionCatcher=null,this._config=null,this._id=-1,this._released=!1,h.apply(this,arguments),this.release=function(){this._released||this._exceptionCatcher.runProtected("Client.release",function(){
    i._logger.info("release()"),i._sessionFactory.cleanup(),i._sessionFactory=null,i._globalSessionKey=-1,i._logger=null,i._id=-1,i._exceptionCatcher=null,i._settings=null,i._systemSettings=null,i._systemFactory=null,
        i._released=!0})},this.createSession=function(a){if(!this._released){var c=b.NO_SESSION_KEY;return this._exceptionCatcher.runProtected("Client.createSession",function(){c=i._sessionFactory.makeVideoSession(a);
}),c}},this.reportError=function(a,b,c){this._released||this._exceptionCatcher.runProtected("Client.reportError",function(){var d=i._sessionFactory.getVideoSession(a);null!=d&&d.reportError(b,c)})},this.updateContentMetadata=function(a,b){
    this._released||this._exceptionCatcher.runProtected("Client.updateContentMetadata",function(){var c=i._sessionFactory.getVideoSession(a);null!=c&&c.updateContentMetadata(b)})},this.detachPlayer=function(a){
    this._released||this._exceptionCatcher.runProtected("Client.detachPlayer",function(){var b=i._sessionFactory.getVideoSession(a);null!=b&&b.detachPlayer()})},this.attachPlayer=function(a,b){return this._released?void 0:b instanceof g?void this._exceptionCatcher.runProtected("Client.attachPlayer",function(){
    var c=i._sessionFactory.getVideoSession(a);null!=c&&c.attachPlayer(b)}):void i._logger.error("attachPlayer(): expecting an instance of PlayerStateManager for playerStateManager parameter")},this.contentPreload=function(a){
    this._released||this._exceptionCatcher.runProtected("Client.contentPreload",function(){var b=i._sessionFactory.getVideoSession(a);null!=b&&b.contentPreload()})},this.contentStart=function(a){this._released||this._exceptionCatcher.runProtected("Client.contentStart",function(){
    var b=i._sessionFactory.getVideoSession(a);null!=b&&b.contentStart()})},this.sendCustomEvent=function(a,c,e){this._released||this._exceptionCatcher.runProtected("Client.sendCustomEvent",function(){if(a==b.NO_SESSION_KEY){
    if(i._globalSessionKey<0){var f=new d;i._globalSessionKey=i._sessionFactory.makeGlobalSession(f,null)}a=i._globalSessionKey}var g=null;g=G.DictionaryFromRepr(e);var h=i._sessionFactory.getSession(a);null!=h&&h.sendCustomEvent(c,g);
})},this.adStart=function(a,c,d,e){return this._released?void 0:c!==b.AdStream.CONTENT&&c!==b.AdStream.SEPARATE?void this._logger.error("adStart(): ignored, invalid value for adStream parameter: "+c):d!==b.AdPlayer.CONTENT&&d!==b.AdPlayer.SEPARATE?void this._logger.error("adStart(): ignored, invalid value for adPlayer parameter: "+d):e!==b.AdPosition.PREROLL&&e!==b.AdPosition.MIDROLL&&e!==b.AdPosition.POSTROLL?void this._logger.error("adStart(): ignored, invalid value for adPosition parameter: "+e):void this._exceptionCatcher.runProtected("Client.adStart",function(){
    var b=i._sessionFactory.getVideoSession(a);null!=b&&b.adStart(c,d,e)})},this.adEnd=function(a){this._released||this._exceptionCatcher.runProtected("Client.adEnd",function(){var b=i._sessionFactory.getVideoSession(a);
    null!=b&&b.adEnd()})},this.cleanupSession=function(a){this._released||this._exceptionCatcher.runProtected("Client.cleanupSession",function(){var b=i._sessionFactory.getVideoSession(a);null!=b&&i._sessionFactory.cleanupSession(a);
})},this.getPlayerStateManager=function(){if(this._released)throw new Error("This instance of Conviva.Client has been released.");return new g(this._systemFactory)},this.releasePlayerStateManager=function(a){
    if(this._released)throw new Error("This instance of Conviva.Client has been released.");this._exceptionCatcher.runProtected("Client.releasePlayerStateManager",function(){a instanceof g&&a.release()})},
    this.getSettings=function(){return this._released?void 0:this._settings},this.getId=function(){return this._id}};b.version="2.91.0.24548",b.NO_SESSION_KEY=-2,b.AdPosition={PREROLL:"PREROLL",MIDROLL:"MIDROLL",
    POSTROLL:"POSTROLL"},b.AdStream={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},b.AdPlayer={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},b.ErrorSeverity={FATAL:0,WARNING:1},b.DeviceType={DESKTOP:"DESKTOP",CONSOLE:"Console",
    SETTOP:"Settop",MOBILE:"Mobile",TABLET:"Tablet",SMARTTV:"SmartTV",UNKNOWN:"Unknown"};var c=a.ClientSettings=function(a){function b(a){if(!G.isValidString(a))throw new Error("customerKey must be valid");
    this.customerKey=a}this.customerKey=null,this.heartbeatInterval=c.defaultProductionHeartbeatInterval,this.gatewayUrl=c.defaultProductionGatewayUrl,b.apply(this,arguments),this.sanitize=function(){var a=this.heartbeatInterval;
    if(this.heartbeatInterval=c.defaultProductionHeartbeatInterval,"number"==typeof a){var b=G.NumberToUnsignedInt(a);b===a&&(this.heartbeatInterval=b)}var d=this.gatewayUrl;this.gatewayUrl=c.defaultProductionGatewayUrl,
    G.isValidString(d)&&(this.gatewayUrl=d)}};c.defaultDevelopmentGatewayUrl="https://testonly.conviva.com",c.defaultProductionGatewayUrl="https://cws.conviva.com",c.defaultDevelopmentHeartbeatInterval=5,c.defaultProductionHeartbeatInterval=20;
    var d=a.ContentMetadata=function(){function a(){return this._custom}function b(a){function b(a){return null!=a&&"undefined"!=a&&"null"!=a&&""!=a}if("object"==typeof a){var c={};for(var d in a)if(b(d)){
        var e=a[d];b(e)&&(c[d]=e)}this._custom=c}}function c(){return this._defaultBitrateKbps}function e(a){this._defaultBitrateKbps=g.sanitizeBitrateKbps(a)}function f(){return this._streamType}function h(a){
        (a===d.StreamType.UNKNOWN||a===d.StreamType.VOD||a===d.StreamType.LIVE)&&(this._streamType=a)}function i(){return this._duration}function j(a){this._duration=K.Integer(a,0,null,-1)}function k(){return this._encodedFrameRate;
    }function l(a){this._encodedFrameRate=K.Integer(a,0,null,-1)}function m(){}this.assetName=null,this._custom={},G.defGet(this,"custom",a),G.defSet(this,"custom",b),this._defaultBitrateKbps=-2,G.defGet(this,"defaultBitrateKbps",c),
        G.defSet(this,"defaultBitrateKbps",e),this.defaultResource=null,this.viewerId=null,this.applicationName=null,this.streamUrl=null,this._streamType=d.StreamType.UNKNOWN,G.defGet(this,"streamType",f),G.defSet(this,"streamType",h),
        this._duration=null,G.defGet(this,"duration",i),G.defSet(this,"duration",j),this._encodedFrameRate=-1,G.defGet(this,"encodedFrameRate",k),G.defSet(this,"encodedFrameRate",l),m.apply(this,arguments)};d.ConstructClone=function(a){
        if(null==a)return null;var b=new d;b.assetName=a.assetName,b.applicationName=a.applicationName,b.streamUrl=a.streamUrl,b.viewerId=a.viewerId,b.defaultBitrateKbps=a.defaultBitrateKbps,b.defaultResource=a.defaultResource,
            b.streamType=a.streamType,b.duration=a.duration,b.encodedFrameRate=a.encodedFrameRate;for(var c in a.custom)b.custom[c]=a.custom[c];return b},d.StreamType={UNKNOWN:"UNKNOWN",LIVE:"LIVE",VOD:"VOD"};var e=a.SystemFactory=function(a,b){
        function c(a,b){this._systemInterface=a,this._timeInterface=this._systemInterface._timeInterface,this._timerInterface=this._systemInterface._timerInterface,this._httpInterface=this._systemInterface._httpInterface,
            this._storageInterface=this._systemInterface._storageInterface,this._metadataInterface=this._systemInterface._metadataInterface,this._loggingInterface=this._systemInterface._loggingInterface,b instanceof f||(b=new f),
            this._settings=b,this._settings.sanitize()}c.apply(this,arguments),this.configure=function(a,b){this._packageName=a,this._clientSettings=b},this.release=function(){"function"==typeof this._systemInterface.release&&(this._systemInterface.release(),
            this._systemInterface=null),this._packageName=null,this._settings=null,this._logBuffer=null};var d=this,e={build:function(){return new M(d._loggingInterface,d._timeInterface,d.getSettings(),d._logBuffer,d._packageName);
        }};this.buildLogger=function(){return e.build()},this.buildSessionFactory=function(a,b,c){return new u(a,b,c,this)},this.buildPing=function(){return new A(this.buildLogger(),this.buildHttpClient(),this._clientSettings);
        },this.buildCallbackWithTimeout=function(){return new v(this.buildTimer())},this.buildHttpClient=function(){return new L(this.buildLogger(),this._httpInterface,this.getSettings())},this.buildExceptionCatcher=function(){
            return new y(this.buildLogger(),this.buildPing(),this.getSettings())},this.buildTime=function(){return new P(this._timeInterface)},this.buildTimer=function(){return new Q(this._timerInterface,this.buildExceptionCatcher());
        },this.buildStorage=function(){return new N(this._storageInterface)},this.buildConfig=function(){return new w(this.buildLogger(),this.buildStorage(),this.buildJsonInterface(),this.buildCallbackWithTimeout(),this.getSettings());
        },this.buildSystemMetadata=function(){return new O(this._metadataInterface,this.buildExceptionCatcher())},this.buildProtocol=function(){return new r},this.buildJsonInterface=function(){return new q},this.getLogBuffer=function(){
            return this._logBuffer},this.getSettings=function(){return this._settings},this._logBuffer=new z},f=a.SystemSettings=function(){function a(){}this.logLevel=f.defaultProductionLogLevel,this.allowUncaughtExceptions=f.defaultProductionAllowUncaughtExceptions,
        this.storageTimeout=f.defaultStorageTimeout,this.httpTimeout=f.defaultHttpTimeout,a.apply(this,arguments),this.sanitize=function(){var a=this.logLevel;if(this.logLevel=f.defaultProductionLogLevel,"number"==typeof a){
        var b=G.NumberToUnsignedInt(a);b===a&&b>=f.LogLevel.DEBUG&&b<=f.LogLevel.ERROR&&(this.logLevel=b)}var c=this.allowUncaughtExceptions;this.allowUncaughtExceptions=f.defaultProductionAllowUncaughtExceptions,
    G.isBoolean(c)&&(this.allowUncaughtExceptions=c);var d=this.storageTimeout;if(this.storageTimeout=f.defaultStorageTimeout,"number"==typeof d){var e=G.NumberToUnsignedInt(d);e===d&&(this.storageTimeout=e);
    }var g=this.httpTimeout;if(this.httpTimeout=f.defaultHttpTimeout,"number"==typeof g){var h=G.NumberToUnsignedInt(g);h===g&&(this.httpTimeout=h)}}};f.LogLevel={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},f.defaultDevelopmentLogLevel=f.LogLevel.DEBUG,
        f.defaultProductionLogLevel=f.LogLevel.ERROR,f.defaultDevelopmentAllowUncaughtExceptions=!0,f.defaultProductionAllowUncaughtExceptions=!1,f.defaultStorageTimeout=10,f.defaultHttpTimeout=10;var g=a.PlayerStateManager=function(a){
        function b(a){c._systemFactory=a,c._logger=c._systemFactory.buildLogger(),c._logger.setModuleName("PlayerStateManager"),c._exceptionCatcher=c._systemFactory.buildExceptionCatcher()}var c=this;c._monitorNotifier=null,
            c._bitrateKbps=-2,c._playerState=g.PlayerState.UNKNOWN,c._currentMetadata={},c._renderedFrameRate=-1,c._encodedFrameRate=-1,c._duration=-1,c._playerVersion=null,c._playerType=null,c._lastError=null,c._pendingErrors=new H,
            this.release=function(){c._exceptionCatcher&&c._exceptionCatcher.runProtected("PlayerStateManager.release",function(){c.notifyListeners(s.REASON_RELEASE),c.removeMonitoringNotifier()})},this.getRenderedFrameRate=function(){
            return c._renderedFrameRate},this.setRenderedFrameRate=function(a){c._exceptionCatcher&&c._exceptionCatcher.runProtected("PlayerStateManager.setRenderedFrameRate",function(){c._renderedFrameRate=K.Integer(a,-1,null,-1);
        })},this.getEncodedFrameRate=function(){return c._encodedFrameRate},this.setEncodedFrameRate=function(a){c._exceptionCatcher&&c._exceptionCatcher.runProtected("PlayerStateManager.setEncodedFrameRate",function(){
            c._encodedFrameRate=K.Integer(a,0,null,-1);var b={};b[s.METADATA_ENCODED_FRAMERATE]=c._encodedFrameRate.toString(),c.setMetadata(b)})},this.getDuration=function(){return c._duration},this.setDuration=function(a){
            c._exceptionCatcher&&c._exceptionCatcher.runProtected("PlayerStateManager.setDuration",function(){c._duration=K.Integer(a,0,null,-1);var b={};b[s.METADATA_DURATION]=c._duration.toString(),c.setMetadata(b);
            })},this.getPlayerType=function(){return c._playerType},this.setPlayerType=function(a){c._playerType=a},this.getPlayerVersion=function(){return c._playerVersion},this.setPlayerVersion=function(a){c._playerVersion=a;
        },this.setMonitoringNotifier=function(a,b){return null!=c._monitorNotifier?!1:(c._monitorNotifier=a,c._logger&&c._logger.setSessionId(b),!0)},this.removeMonitoringNotifier=function(){c._monitorNotifier=null,
        c._logger&&c._logger.setSessionId(null)},this.pushCurrentState=function(){if(null!=c._monitorNotifier){c.setPlayerState(c.getPlayerState()),c.setBitrateKbps(c.getBitrateKbps()),c.setMetadata(c.getMetadata());
            for(var a=c._pendingErrors.Values(),b=0;b<a.length;b++){var d=a[b];c.setError(d)}c._pendingErrors.Clear()}},this.getPlayerState=function(){return c._playerState},this.setPlayerState=function(a){c._exceptionCatcher&&c._exceptionCatcher.runProtected("PlayerStateManager.setPlayerState",function(){
            g.isValidPlayerState(a)?(c.notifyListeners(s.REASON_PLAYERSTATECHANGE,a),c._playerState=a):c._logger&&c._logger.error("PlayerStateManager.SetPlayerState(): invalid state: "+a)})},this.getBitrateKbps=function(){
            return c._bitrateKbps},this.setBitrateKbps=function(a){c._exceptionCatcher&&c._exceptionCatcher.runProtected("PlayerStateManager.setBitrateKbps",function(){var b=g.sanitizeBitrateKbps(a);b>=-1&&(c.notifyListeners(s.REASON_BITRATECHANGE,b),
            c._bitrateKbps=b)})},this.setError=function(a){c._lastError=a,null!=c._monitorNotifier?c.notifyListeners(s.REASON_ERRORCHANGE,c._lastError):c._pendingErrors.Add(c._lastError)},this.sendError=function(a,b){
            c._exceptionCatcher&&c._exceptionCatcher.runProtected("PlayerStateManager.sendError",function(){var d=new Conviva.PrivateLoader.StreamerError(a,b);c.setError(d)})},this.reset=function(){c._exceptionCatcher&&c._exceptionCatcher.runProtected("PlayerStateManager.reset",function(){
            c._bitrateKbps=-2,c._playerState=g.PlayerState.UNKNOWN,c._currentMetadata={},c._renderedFrameRate=-1,c._encodedFrameRate=-1,c._duration=-1,c._playerVersion=null,c._playerType=null,c._lastError=null,c._pendingErrors=new H;
        })},this.getError=function(){return c._lastError},this.getMetadata=function(){return c._currentMetadata},this.setMetadata=function(a){for(var b in a)c._currentMetadata[b]=a[b];c.notifyListeners(s.REASON_METADATACHANGE,c._currentMetadata);
        },this.log=function(a,b){c._logger&&c._logger.log(a,b)},this.notifyListeners=function(a,b){null!=c._monitorNotifier&&c.notifyListener(c._monitorNotifier,a,b)},this.notifyListener=function(a,b,d){c._exceptionCatcher&&c._exceptionCatcher.runProtected("PlayerStateManager.notifyListener",function(){
            a(b,d)})},b.apply(c,arguments)};g.PlayerState={STOPPED:"STOPPED",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",UNKNOWN:"UNKNOWN",NOT_MONITORED:"NOT_MONITORED"},g.isValidPlayerState=function(a){
        return a===g.PlayerState.STOPPED||a===g.PlayerState.PLAYING||a===g.PlayerState.BUFFERING||a===g.PlayerState.PAUSED||a===g.PlayerState.UNKNOWN||a===g.PlayerState.NOT_MONITORED?!0:!1},g.sanitizeBitrateKbps=function(a){
        return-1==a||-2==a?a:a=K.Integer(a,0,null,-1)};var h=a.HttpInterface=function(){this.makeRequest=function(a,b,c,d,e,f){},this.release=function(){}},i=a.LoggingInterface=function(){this.consoleLog=function(a,b){},
        this.release=function(){}},j=a.MetadataInterface=function(){this.getBrowserName=function(){},this.getBrowserVersion=function(){},this.getDeviceBrand=function(){},this.getDeviceManufacturer=function(){},
        this.getDeviceModel=function(){},this.getDeviceType=function(){},this.getDeviceVersion=function(){},this.getFrameworkName=function(){},this.getFrameworkVersion=function(){},this.getOperatingSystemName=function(){},
        this.getOperatingSystemVersion=function(){},this.release=function(){}},k=a.StorageInterface=function(){this.saveData=function(a,b,c,d){},this.loadData=function(a,b,c){},this.release=function(){}},l=a.SystemInterface=function(a,b,c,d,e,f){
        function g(a,b,c,d,e,f){l.validateInterface(a,new m,"TimeInterface"),l.validateInterface(b,new n,"TimerInterface"),l.validateInterface(c,new h,"HttpInterface"),l.validateInterface(d,new k,"StorageInterface"),
            l.validateInterface(e,new j,"MetadataInterface"),l.validateInterface(f,new i,"LoggingInterface"),this._timeInterface=a,this._timerInterface=b,this._httpInterface=c,this._storageInterface=d,this._metadataInterface=e,
            this._loggingInterface=f}g.apply(this,arguments),this.release=function(){null!=this._timeInterface&&(this._timeInterface.release(),this._timeInterface=null),null!=this._timerInterface&&(this._timerInterface.release(),
            this._timerInterface=null),null!=this._httpInterface&&(this._httpInterface.release(),this._httpInterface=null),null!=this._storageInterface&&(this._storageInterface.release(),this._storageInterface=null),
        null!=this._metadataInterface&&(this._metadataInterface.release(),this._metadataInterface=null),null!=this._loggingInterface&&(this._loggingInterface.release(),this._loggingInterface=null)}};l.validateInterface=function(a,b,c){
        for(var d in b)if("release"!==d&&"function"!=typeof a[d])throw new Error("Expected method "+d+" in "+c+" implementation.")};var m=a.TimeInterface=function(){this.getEpochTimeMs=function(){},this.release=function(){};
    },n=a.TimerInterface=function(){this.createTimer=function(a,b,c){},this.release=function(){}},o=a.JSON2={};!function(){function a(a){return 10>a?"0"+a:a}function b(a){return d.lastIndex=0,d.test(a)?'"'+a.replace(d,function(a){
        var b=g[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var g,i,j,k,l,m=e,n=d[a];switch(n&&"object"==typeof n&&"function"==typeof n.toJSON&&(n=n.toJSON(a)),
    "function"==typeof h&&(n=h.call(d,a,n)),typeof n){case"string":return b(n);case"number":return isFinite(n)?String(n):"null";case"boolean":case"null":return String(n);case"object":if(!n)return"null";if(e+=f,
            l=[],"[object Array]"===Object.prototype.toString.apply(n)){for(k=n.length,g=0;k>g;g+=1)l[g]=c(g,n)||"null";return j=0===l.length?"[]":e?"[\n"+e+l.join(",\n"+e)+"\n"+m+"]":"["+l.join(",")+"]",e=m,j}if(h&&"object"==typeof h)for(k=h.length,
                                                                                                                                                                                                                                                   g=0;k>g;g+=1)"string"==typeof h[g]&&(i=h[g],j=c(i,n),j&&l.push(b(i)+(e?": ":":")+j));else for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(j=c(i,n),j&&l.push(b(i)+(e?": ":":")+j));return j=0===l.length?"{}":e?"{\n"+e+l.join(",\n"+e)+"\n"+m+"}":"{"+l.join(",")+"}",
        e=m,j}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null;
    },String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d,e,f,g,h;"function"!=typeof o.stringify&&(d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
        g={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o.stringify=function(a,b,d){var g;if(e="",f="","number"==typeof d)for(g=0;d>g;g+=1)f+=" ";else"string"==typeof d&&(f=d);if(h=b,
        b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON2.stringify");return c("",{"":a})})}();var p=a.JsonParse=function(){var a,b,c,d,e={'"':'"',"\\":"\\","/":"/",
        b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},f=function(b){throw{name:"SyntaxError",message:b,at:a,text:c}},g=function(d){return d&&d!==b&&f("Expected '"+d+"' instead of '"+b+"'"),b=c.charAt(a),a+=1,b},h=function(){
        var a,c="";for("-"===b&&(c="-",g("-"));b>="0"&&"9">=b;)c+=b,g();if("."===b)for(c+=".";g()&&b>="0"&&"9">=b;)c+=b;if("e"===b||"E"===b)for(c+=b,g(),("-"===b||"+"===b)&&(c+=b,g());b>="0"&&"9">=b;)c+=b,g();return a=+c,
            isNaN(a)?void f("Bad number"):a},i=function(){var a,c,d,h="";if('"'===b)for(;g();){if('"'===b)return g(),h;if("\\"===b)if(g(),"u"===b){for(d=0,c=0;4>c&&(a=parseInt(g(),16),isFinite(a));c+=1)d=16*d+a;h+=String.fromCharCode(d);
    }else{if("string"!=typeof e[b])break;h+=e[b]}else h+=b}f("Bad string")},j=function(){for(;b&&" ">=b;)g()},k=function(){switch(b){case"t":return g("t"),g("r"),g("u"),g("e"),!0;case"f":return g("f"),g("a"),
        g("l"),g("s"),g("e"),!1;case"n":return g("n"),g("u"),g("l"),g("l"),null}f("Unexpected '"+b+"'")},l=function(){var a=[];if("["===b){if(g("["),j(),"]"===b)return g("]"),a;for(;b;){if(a.push(d()),j(),"]"===b)return g("]"),
        a;g(","),j()}}f("Bad array")},m=function(){var a,c={};if("{"===b){if(g("{"),j(),"}"===b)return g("}"),c;for(;b;){if(a=i(),j(),g(":"),Object.hasOwnProperty.call(c,a)&&f('Duplicate key "'+a+'"'),c[a]=d(),
            j(),"}"===b)return g("}"),c;g(","),j()}}f("Bad object")};return d=function(){switch(j(),b){case"{":return m();case"[":return l();case'"':return i();case"-":return h();default:return b>="0"&&"9">=b?h():k();
    }},function(e,g){var h;return c=e,a=0,b=" ",h=d(),j(),b&&f("Syntax error"),"function"==typeof g?function i(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.hasOwnProperty.call(e,c)&&(d=i(e,c),
        void 0!==d?e[c]=d:delete e[c]);return g.call(a,b,e)}({"":h},""):h}}(),q=(a.JSONInterface=function(){this.encode=function(a){},this.decode=function(a){}},a.LibJSONInterface=function(){this.encode=function(a){
        var b=null;try{b=o.stringify(a)}catch(c){}return b},this.decode=function(a){var b=null;try{b=p(a)}catch(c){}return"object"!=typeof b&&(b=null),b}}),r=a.Protocol=function(){this.buildPlatformMetadata=function(a){
        return{sch:r.SDK_METADATA_SCHEMA,br:a[O.BROWSER_NAME],brv:a[O.BROWSER_VERSION],dvb:a[O.DEVICE_BRAND],dvma:a[O.DEVICE_MANUFACTURER],dvm:a[O.DEVICE_MODEL],dvt:a[O.DEVICE_TYPE],dvv:a[O.DEVICE_VERSION],fw:a[O.FRAMEWORK_NAME],
            fwv:a[O.FRAMEWORK_VERSION],os:a[O.OPERATING_SYSTEM_NAME],osv:a[O.OPERATING_SYSTEM_VERSION]}}};r.version="1.7",r.gatewayPath="/0/wsg",r.DEFAULT_CLIENT_ID="0",r.BACKEND_RESPONSE_NO_ERRORS="ok",r.SDK_METADATA_SCHEMA="sdk.js.1",
        r.convertPlayerState=function(a){switch(a){case g.PlayerState.STOPPED:return r.eStopped;case g.PlayerState.PLAYING:return r.ePlaying;case g.PlayerState.BUFFERING:return r.eBuffering;case g.PlayerState.PAUSED:
            return r.ePaused;case g.PlayerState.NOT_MONITORED:return r.eNotMonitored;default:return r.eUnknown}},r.eStopped=1,r.ePlaying=3,r.eBuffering=6,r.ePaused=12,r.eNotMonitored=98,r.eUnknown=100,r.SessionFlags={
        GLOBAL:0,VIDEO:1,QUALITY_METRICS:2,BITRATE_METRICS:4};var s=a.Monitor=function(){function a(a,c,d,e){b._sessionId=a,b._eventQueue=c,b._contentMetadata=d,b._systemFactory=e,b._logger=b._systemFactory.buildLogger(),
        b._logger.setModuleName("Monitor"),b._logger.setSessionId(G.ToString(b._sessionId)),b._exceptionCatcher=b._systemFactory.buildExceptionCatcher(),b._time=b._systemFactory.buildTime()}var b=this;b._sessionId=0,
        b._playerStateManager=null,b._eventQueue=null,b._contentMetadata=null,b._bitrateKbps=-2,b._resource=null,b._playerState=g.PlayerState.NOT_MONITORED,b._sessionFlags=r.SessionFlags.VIDEO+r.SessionFlags.QUALITY_METRICS+r.SessionFlags.BITRATE_METRICS,
        b._startTimeMs=0,b._hasJoined=!1,b._pauseJoin=!1,b._encodedFps=-1,b._contentLengthSec=-1,b._playingFpsObservationCount=0,b._playingFpsTotal=0,b._averageFps=-1,b._adPlaying=!1,b._adStream=null,b._adPlayer=null,
        b._adPosition=null,b._ignorePlayerState=!1,b._pooledPlayerState=g.PlayerState.NOT_MONITORED,b._ignoreBitrateAndResource=!1,b._ignoreError=!1,this.start=function(a){b._startTimeMs=a},this.setDefaultBitrateAndResource=function(){
        b._logger.debug("setDefaultBitrateAndResource()"),null!=b._contentMetadata&&(b._contentMetadata.defaultBitrateKbps>0&&b._bitrateKbps<0&&b.setBitrateKbps(b._contentMetadata.defaultBitrateKbps),null!=b._contentMetadata.defaultResource&&null==b._resource&&b.setResource(b._contentMetadata.defaultResource));
    },this.setBitrateKbps=function(a){if(b._logger.debug("setBitrateKbps()"),b._ignoreBitrateAndResource)return void b._logger.info("setBitrateKbps(): ignored");var c=b._bitrateKbps;c!==a&&a>=-1&&(b._logger.info("Change bitrate from "+c+" to "+a,b._sessionId),
        b.enqueueBitrateChangeEvent(c,a),b._bitrateKbps=a)},this.setResource=function(a){if(b._logger.debug("setResource()"),b._ignoreBitrateAndResource)return void b._logger.info("setResource(): ignored");var c=b._resource;
        c!==a&&null!==a&&(b._logger.info("Change resource from "+c+" to "+a,b._sessionId),b.enqueueResourceChangeEvent(c,a),b._resource=a)},this.attachPlayer=function(a){return b._logger.debug("attachPlayer()"),
        null!=b._playerStateManager?void b._logger.error("attachPlayer(): detach current PlayerStateManager first"):void b._exceptionCatcher.runProtected("Monitor.attachPlayer()",function(){a.setMonitoringNotifier(b.notificationFromStreamerProxy,b._sessionId)?(a.pushCurrentState(),
            b._playerStateManager=a):b._logger.error("attachPlayer(): instance of PlayerStateManager is already attached to a session")})},this.detachPlayer=function(){b._logger.debug("detachPlayer()"),b.updateMetrics(),
    null!==b._playerStateManager&&(b._exceptionCatcher.runProtected("Monitor.detachPlayer",function(){b._playerStateManager.removeMonitoringNotifier()}),b._playerStateManager=null,b.SetPlayerState(g.PlayerState.NOT_MONITORED));
    },this.contentPreload=function(){return b._logger.debug("contentPreload()"),b._preloading?void b._logger.debug("contentPreload(): called twice, ignoring"):(b._preloading=!0,void(b._ignorePlayerState=!0));
    },this.contentStart=function(){return b._logger.debug("contentStart()"),b._preloading?(b._preloading=!1,void(b._adPlaying||(b._ignorePlayerState=!1,b.SetPlayerState(b._pooledPlayerState)))):void b._logger.warning("contentStart(): called without contentPreload, ignoring");
    },this.adStart=function(a,c,d){return b._logger.debug("adStart()"),b._adPlaying?void b._logger.warning("adStart(): multiple adStart calls, ignoring"):(b._adPlaying=!0,b._adStream=a,b._adPlayer=c,b._adPosition=d,
    b._hasJoined||b.togglePauseJoin(!0),void(b._adStream==Conviva.Client.AdStream.CONTENT||b._adPlayer==Conviva.Client.AdPlayer.SEPARATE?(b._playerState!==g.PlayerState.NOT_MONITORED&&(b._pooledPlayerState=b._playerState),
        b.SetPlayerState(g.PlayerState.NOT_MONITORED),b._ignorePlayerState=!0):b._adStream==Conviva.Client.AdStream.SEPARATE&&b._adPlayer==Conviva.Client.AdPlayer.CONTENT&&(b._playerState!==g.PlayerState.NOT_MONITORED&&(b._pooledPlayerState=b._playerState),
        b.SetPlayerState(g.PlayerState.NOT_MONITORED),b._ignorePlayerState=!0,b._ignoreBitrateAndResource=!0,b._ignoreError=!0)))},this.adEnd=function(){return b._logger.debug("adEnd()"),b._adPlaying?(b._hasJoined||b.togglePauseJoin(!1),
        b._adStream==Conviva.Client.AdStream.CONTENT||b._adPlayer==Conviva.Client.AdPlayer.SEPARATE?b._preloading||(b._ignorePlayerState=!1,b.SetPlayerState(b._pooledPlayerState)):b._adStream==Conviva.Client.AdStream.SEPARATE&&b._adPlayer==Conviva.Client.AdPlayer.CONTENT&&(b._ignoreBitrateAndResource=!1,
            b._ignoreError=!1,b._preloading||(b._ignorePlayerState=!1,b.SetPlayerState(b._pooledPlayerState))),b._adPlaying=!1,void(b._adStream=b._adPlayer=b._adPosition=null)):void b._logger.debug("adEnd(): called before adStart, ignoring");
    },this.togglePauseJoin=function(a){if(b._logger.debug("togglePauseJoin()"),b._pauseJoin===a)return void b._logger.debug("togglePauseJoin(): same value, ignoring");var c=new E,d=new E;d.SetValue("pj",b._pauseJoin),
        b._pauseJoin=!b._pauseJoin,c.SetValue("pj",b._pauseJoin),b.declareStateChange(c,d)},this.notificationFromStreamerProxy=function(a,c){b._logger.debug("notificationFromStreamerProxy(): "+a),b._exceptionCatcher.runProtected("Monitor.notificationFromStreamerProxy",function(){
        switch(a){case s.REASON_PLAYERSTATECHANGE:var d=c;b.OnPlayerStateChange(d);break;case s.REASON_BITRATECHANGE:var e=c;b.setBitrateKbps(e);break;case s.REASON_ERRORCHANGE:var f=c;b.OnError(f);break;case s.REASON_METADATACHANGE:
            b.OnMetadata(c);break;case s.REASON_RELEASE:b.detachPlayer()}})},this.OnPlayerStateChange=function(a){if(b._playerState!=a){if(b._playerState==g.PlayerState.NOT_MONITORED&&a!=g.PlayerState.NOT_MONITORED&&(b._pooledPlayerState=a),
            b._ignorePlayerState)return void b._logger.debug("OnPlayerStateChange(): "+a+" (pooled, "+(b._adPlaying?"ad playing":"preloading")+")");b._logger.debug("OnPlayerStateChange(): "+a);var c=new E,d=new E;c.SetValue("ps",r.convertPlayerState(a)),
        d.SetValue("ps",r.convertPlayerState(b._playerState)),b._hasJoined||a!=g.PlayerState.PLAYING||(b.togglePauseJoin(!1),b._hasJoined=!0),b._logger.info("OnPlayerStateChange(): changing player state from "+b._playerState+" to "+a),
        b._playerState=a,b.declareStateChange(c,d)}},this.SetPlayerState=function(a){b._playerState!=a&&b.OnPlayerStateChange(a)},this.OnError=function(a){return"string"!=typeof a.errorCode||""===a.errorCode?void b._logger.error("OnError(): invalid error message string: "+a.errorCode):a.severity!==Conviva.Client.ErrorSeverity.FATAL&&a.severity!==Conviva.Client.ErrorSeverity.WARNING?void b._logger.error("OnError(): invalid error severity: "+a.severity):b._ignoreError?void b._logger.debug("OnError(): ignored"):void b.declareError(a.errorCode,a.severity==Conviva.Client.ErrorSeverity.FATAL);
    },this.OnMetadata=function(a){var c=G.DictionaryFromRepr(a);if(c.ContainsKey(s.METADATA_ENCODED_FRAMERATE)){var d=c.GetValue(s.METADATA_ENCODED_FRAMERATE),e=G.StringToIntSafe(d,-1);e>0?(b._encodedFps=e,
        b._logger.info("OnMetadata(): Received "+s.METADATA_ENCODED_FRAMERATE+" metadata: "+b._encodedFps,b._sessionId)):b._logger.warning("OnMetadata(): Ignored invalid "+s.METADATA_ENCODED_FRAMERATE+" metadata: "+d,b._sessionId);
    }if(c.ContainsKey(s.METADATA_DURATION)){var f=c.GetValue(s.METADATA_DURATION),g=G.StringToIntSafe(f,-1);g>0?(b._contentLengthSec=K.Integer(g,0,null,-1),b._logger.info("OnMetadata(): Received "+s.METADATA_DURATION+" metadata: "+b._contentLengthSec,b._sessionId)):b._logger.warning("OnMetadata(): Ignored invalid "+s.METADATA_DURATION+" metadata: "+f,b._sessionId);
    }},this.updateHeartbeat=function(a){if(b.updateMetrics(),I.setDictValue(a,"ps",r.convertPlayerState(b._playerState)),I.setDictValue(a,"pj",b._pauseJoin),I.setDictValue(a,"sf",b._sessionFlags),null!=b._contentMetadata&&b._contentMetadata.duration>0){
        var c=K.Integer(b._contentMetadata.duration,0,null,-1);I.setDictValue(a,"cl",c)}else b._contentLengthSec>0&&I.setDictValue(a,"cl",b._contentLengthSec);if(b._bitrateKbps>0&&I.setDictValue(a,"br",b._bitrateKbps),
        null!==b._resource&&I.setDictValue(a,"rs",b._resource),null!=b._contentMetadata&&b._contentMetadata.encodedFrameRate>0?I.setDictValue(a,"efps",b._contentMetadata.encodedFrameRate):b._encodedFps>0&&I.setDictValue(a,"efps",b._encodedFps),
        b._averageFps>=0&&I.setDictValue(a,"afps",b._averageFps),null!=b._playerStateManager){if(null==a.pm.fw){var d=null;b._exceptionCatcher.runProtected("Monitor.updateHeartbeat:PlayerType",function(){d=b._playerStateManager.getPlayerType();
    }),null!=d&&(a.pm.fw=d)}if(null==a.pm.fwv){var e=null;b._exceptionCatcher.runProtected("Monitor.updateHeartbeat:PlayerVersion",function(){e=b._playerStateManager.getPlayerVersion()}),null!=e&&(a.pm.fwv=e);
    }}},this.cleanup=function(){null!=b._playerStateManager&&b.detachPlayer(),b._eventQueue=null,b._contentMetadata=null,b._streamInfo=null},this.updateMetrics=function(){if(null!=b._playerStateManager&&b._playerState==g.PlayerState.PLAYING){
        var a=b._playerStateManager.getRenderedFrameRate();a>=0&&(b._playingFpsTotal+=a,b._playingFpsObservationCount++,b._averageFps=G.slint.Cast(1*b._playingFpsTotal/b._playingFpsObservationCount))}},this.getSessionTime=function(){
        return G.slint.Cast(b._time.current()-b._startTimeMs)},this.enqueueEvent=function(a,c){c.SetValue("t",a),c.SetValue("st",b.getSessionTime()),c.SetValue("seq",b._eventQueue.getNumber()),b._eventQueue.enqueue(G.StringDictionaryToRepr(c));
    },this.enqueueBitrateChangeEvent=function(a,c){var d=new E,e=new E;a>=-1&&e.SetValue("br",a),d.SetValue("br",c),b.declareStateChange(d,e)},this.enqueueResourceChangeEvent=function(a,c){var d=new E,e=new E;
        null!==a&&e.SetValue("rs",a),d.SetValue("rs",c),b.declareStateChange(d,e)},this.declareError=function(a,c){var d=new E;d.SetValue("ft",c),d.SetValue("err",a),b.enqueueEvent("CwsErrorEvent",d)},this.declareStateChange=function(a,c){
        var d=G.StringDictionaryToRepr(a),e=G.StringDictionaryToRepr(c),f=new E;f.SetValue("new",d),null!=c&&I.dictCount(e)>0&&f.SetValue("old",e),b.enqueueEvent("CwsStateChangeEvent",f)},a.apply(b,arguments)};
    s.verifyPlayerStateManager=function(a){return null==a?!1:"object"!=typeof a?!1:"function"!=typeof a.getStateManager?!1:a.getStateManager()instanceof g?!0:!1},s.REASON_PLAYERSTATECHANGE="PlayerStateChange",
        s.REASON_BITRATECHANGE="BitrateChange",s.REASON_METADATACHANGE="MetadataChange",s.REASON_ERRORCHANGE="ErrorChange",s.REASON_RELEASE="Release",s.REASON_LOG="Log",s.METADATA_DURATION="duration",s.METADATA_ENCODED_FRAMERATE="framerate";
    var t=a.Session=function(){function a(a,b,d,e,f,g,h,i){c._id=a,c._eventQueue=b,c._contentMetadata=d,c._monitor=e,c._client=f,c._clientSettings=g,c._clientConfig=h,c._systemFactory=i,c._time=c._systemFactory.buildTime(),
        c._timer=c._systemFactory.buildTimer(),c._jsonInterface=c._systemFactory.buildJsonInterface(),c._exceptionCatcher=c._systemFactory.buildExceptionCatcher(),c._logger=c._systemFactory.buildLogger(),c._logger.setModuleName("Session"),
        c._logger.setSessionId(G.ToString(c._id)),c._httpClient=c._systemFactory.buildHttpClient(),c._systemMetadata=c._systemFactory.buildSystemMetadata(),c._protocol=c._systemFactory.buildProtocol(),c._callbackWithTimeout=c._systemFactory.buildCallbackWithTimeout(),
        c._systemSettings=c._systemFactory.getSettings()}var c=this;c._contentMetadata=null,c._clientSettings=null,c._systemFactory=null,c._monitor=null,c._eventQueue=null,c._heartbeatTimerCancel=null,c._id=0,
        c._startTimeMs=0,c._heartbeatSequenceNumber=0,c._cleanedUp=!1,a.apply(c,arguments),this.start=function(){c.isVideoSession()&&null!=c._contentMetadata&&c._logger.info("start(): assetName="+c._contentMetadata.assetName),
        c._startTimeMs=c._time.current(),c.isVideoSession()&&(c._monitor.start(c._startTimeMs),c._monitor.setDefaultBitrateAndResource()),c._heartbeatSequenceNumber=0,c._clientConfig.isReady()?c.sendHeartbeat():(c._onConfigLoaded=function(){
        c.sendHeartbeat()},c._clientConfig.register(c._onConfigLoaded)),c.resetHeartbeatTimer()},this.cleanup=function(){c._logger.info("cleanup()"+c.sessionTypeTag()),c.cancelHeartbeatTimer(),c._logger.debug("Schedule the last hb before session cleanup"+c.sessionTypeTag()),
    c.isVideoSession()&&c.enqueueSessionEndEvent(),c.sendHeartbeat(),c.cleanupAll()},this.cleanupAll=function(){c.isVideoSession()&&(c._monitor.cleanup(),c._monitor=null),c._eventQueue.flush(),c._eventQueue=null,
        c._contentMetadata=null,c._clientSettings=null,c._systemFactory=null,c._time=null,c._timer=null,c._jsonInterface=null,c._logger=null,c._exceptionCatcher=null,c._cleanedUp=!0},this.getSessionTime=function(){
        return G.slint.Cast(c._time.current()-c._startTimeMs)},this.enqueueSessionEndEvent=function(){var a=new E;a.SetValue("t","CwsSessionEndEvent"),a.SetValue("st",c.getSessionTime()),a.SetValue("seq",c._eventQueue.getNumber()),
        c._eventQueue.enqueue(G.StringDictionaryToRepr(a))},this.adStart=function(a,b,d){c._monitor.adStart(a,b,d)},this.adEnd=function(){c._monitor.adEnd()},this.detachPlayer=function(){c._monitor.detachPlayer();
    },this.attachPlayer=function(a){c._monitor.attachPlayer(a)},this.contentPreload=function(){c._monitor.contentPreload()},this.contentStart=function(){c._monitor.contentStart()},this.cancelHeartbeatTimer=function(){
        null!=c._heartbeatTimerCancel&&(c._heartbeatTimerCancel(),c._heartbeatTimerCancel=null)},this.resetHeartbeatTimer=function(){c.cancelHeartbeatTimer();var a=1e3*c._clientSettings.heartbeatInterval;c._heartbeatTimerCancel=c._timer.create(c.sendHeartbeat,a,"Session.sendHeartbeat");
    },this.reportError=function(a,b){c._logger.info("reportError(): "+a),c._monitor.OnError(new C(a,b))},this.updateContentMetadata=function(a){c._logger.debug("updateContentMetadata(): enter"),c._exceptionCatcher.runProtected("Session.updateContentMetadata",function(){
        c.mergeContentMetadata(a),c._monitor.setDefaultBitrateAndResource()})},this.mergeContentMetadata=function(a){if(null==a)return void c._logger.warning("mergeContentMetadata(): null ContentMetadata");null==c._contentMetadata&&(c._contentMetadata=new d),
        null==c._contentMetadata.assetName?c._contentMetadata.assetName=a.assetName:c._logger.warning("mergeContentMetadata(): assetName was already set."),null==c._contentMetadata.applicationName?c._contentMetadata.applicationName=a.applicationName:c._logger.warning("mergeContentMetadata(): applicationName was already set."),
        null==c._contentMetadata.streamUrl?c._contentMetadata.streamUrl=a.streamUrl:c._logger.warning("mergeContentMetadata(): streamUrl was already set."),null==c._contentMetadata.viewerId?c._contentMetadata.viewerId=a.viewerId:c._logger.warning("mergeContentMetadata(): viewerId was already set."),
        c._contentMetadata.defaultBitrateKbps<=0?c._contentMetadata.defaultBitrateKbps=a.defaultBitrateKbps:c._logger.warning("mergeContentMetadata(): defaultBitrateKbps was already set."),null==c._contentMetadata.defaultResource?c._contentMetadata.defaultResource=a.defaultResource:c._logger.warning("mergeContentMetadata(): defaultResource was already set."),
        c._contentMetadata.duration<=0?c._contentMetadata.duration=a.duration:c._logger.warning("mergeContentMetadata(): duration was already set."),c._contentMetadata.encodedFrameRate<=0?c._contentMetadata.encodedFrameRate=a.encodedFrameRate:c._logger.warning("mergeContentMetadata(): encodedFrameRate was already set."),
        c._contentMetadata.streamType==d.StreamType.UNKNOWN?c._contentMetadata.streamType=a.streamType:c._logger.warning("mergeContentMetadata(): streamType was already set.");var b={};for(var e in c._contentMetadata.custom)b[e]=c._contentMetadata.custom[e];
        for(var f in a.custom){var g=b[f];null==g?b[f]=a.custom[f]:c._logger.warning("mergeContentMetadata(): custom."+f+" was already set.")}c._contentMetadata.custom=b},this.sendCustomEvent=function(a,b){c._logger.info("sendEvent(): eventName="+a+c.sessionTypeTag());
        var d=new E;d.SetValue("name",a);var e=G.StringDictionaryToRepr(b);d.SetValue("attr",e),d.SetValue("t","CwsCustomEvent"),d.SetValue("st",c.getSessionTime()),d.SetValue("seq",c._eventQueue.getNumber()),
            c._eventQueue.enqueue(G.StringDictionaryToRepr(d))},this.sendHeartbeat=function(){if(!c._cleanedUp){var a=c.makeHeartbeat();null!=a&&c.encodeAndPostHeartbeat(a,null)}},this.makeHeartbeat=function(){var a={};
        if(I.setDictValue(a,"t","CwsSessionHb"),I.setDictValue(a,"cid",c._clientSettings.customerKey),I.setDictValue(a,"clid",c._clientConfig.get("clientId")),I.setDictValue(a,"sid",c._id),I.setDictValue(a,"seq",c._heartbeatSequenceNumber),
                I.setDictValue(a,"pver",r.version),I.setDictValue(a,"clv",b.version),I.setDictValue(a,"iid",c._client.getId()),I.setDictValue(a,"pm",c._protocol.buildPlatformMetadata(c._systemMetadata.get())),c._contentMetadata&&null!=c._contentMetadata.viewerId&&I.setDictValue(a,"vid",c._contentMetadata.viewerId),
            c._contentMetadata&&null!=c._contentMetadata.streamUrl&&I.setDictValue(a,"url",c._contentMetadata.streamUrl),c._contentMetadata&&null!=c._contentMetadata.applicationName&&I.setDictValue(a,"pn",c._contentMetadata.applicationName),
            c._contentMetadata&&I.dictCount(c._contentMetadata.custom)>0&&I.setDictValue(a,"tags",c._contentMetadata.custom),c.isVideoSession()){if(c._contentMetadata&&null!=c._contentMetadata.assetName&&I.setDictValue(a,"an",c._contentMetadata.assetName),
                c._contentMetadata)switch(c._contentMetadata.streamType){case d.StreamType.LIVE:I.setDictValue(a,"lv",!0);break;case d.StreamType.VOD:I.setDictValue(a,"lv",!1)}c._monitor.updateHeartbeat(a)}else I.setDictValue(a,"sf",r.SessionFlags.GLOBAL);
        var e=c._eventQueue.flush();if(I.setDictValue(a,"evs",e),c.isGlobalSession()&&0===I.listCount(e))return null;I.setDictValue(a,"sdk",!0),c._clientConfig.get("sendLogs")&&I.setDictValue(a,"lg",c._systemFactory.getLogBuffer().flush());
        var f=c._time.current();return I.setDictValue(a,"st",G.slint.Cast(f-c._startTimeMs)),I.setDictValue(a,"cts",f/1e3),c._heartbeatSequenceNumber++,a},this.isGlobalSession=function(){return null==c._monitor;
    },this.isVideoSession=function(){return null!=c._monitor},this.sessionTypeTag=function(){return c.isGlobalSession()?" (global session)":""},this.encodeAndPostHeartbeat=function(a){var b=c._jsonInterface.encode(a),d=c._clientSettings.gatewayUrl+r.gatewayPath,e="application/json";
        c._logger.info("encodeAndPostHeartbeat(): Send HB["+(c._heartbeatSequenceNumber-1)+"]"+c.sessionTypeTag());var f=c._callbackWithTimeout.getWrapperCallback(c.onHeartbeatResponse,1e3*c._systemSettings.httpTimeout,"heartbeat HTTP timeout");
        c._httpClient.request("POST",d,b,e,f)},this.onHeartbeatResponse=function(a,b){c._cleanedUp||c._exceptionCatcher.runProtected("onHeartbeatResponse",function(){if(a){var d=c._jsonInterface.decode(b),e=G.DictionaryFromRepr(d);
        if(null!=e){if(e.ContainsKey("clid")){var f=e.GetValue("clid").toString();f!=c._clientConfig.get("clientId")&&(c._logger.debug("onHeartbeatResponse(): setting the client id to "+f+" (from server)"),c._clientConfig.set("clientId",f),
            c._clientConfig.save())}var g=e.ContainsKey("slg")&&G.isBoolean(e.GetValue("slg"));if(g!==c._clientConfig.get("sendLogs")&&(c._logger.debug("onHeartbeatResponse(): turning "+(g?"on":"off")+" sending of logs"),
                c._clientConfig.set("sendLogs",g)),e.ContainsKey("hbi")){var h=G.slint.Cast(e.GetValue("hbi")),i=h;i!=c._clientSettings.heartbeatInterval&&(c._logger.debug("onHeartbeatResponse(): received hbIntervalMs from server: "+i),
            c._clientSettings.heartbeatInterval=i,null!=c._heartbeatTimerCancel&&c.resetHeartbeatTimer())}if(e.ContainsKey("gw")){var j=e.GetValue("gw");j!=c._clientSettings.gatewayUrl&&(c._logger.debug("onHeartbeatResponse(): received gatewayUrl from server: "+j),
            c._clientSettings.gatewayUrl=j)}if(e.ContainsKey("err")){var k=e.GetValue("err");k!=r.BACKEND_RESPONSE_NO_ERRORS&&c._logger.error("onHeartbeatResponse(): error posting heartbeat: "+k)}}else c._logger.warning("onHeartbeatResponse(): decoded heartbeat response is null.");
    }else G.isValidString(b)?c._logger.error("onHeartbeatResponse(): failed to send heartbeat: "+b):c._logger.error("onHeartbeatResponse(): received no response (or a bad response) to heartbeat POST request");
    })}},u=a.SessionFactory=function(){function a(a,c,d,e){b._client=a,b._clientSettings=c,b._clientConfig=d,b._systemFactory=e,b._logger=b._systemFactory.buildLogger(),b._logger.setModuleName("SessionFactory"),
        b._nextSessionKey=0,b._sessionsByKey=new E}var b=this;b._logger=null,b._logBuffer=null,b._nextSessionKey=0,b._sessionsByKey=null,a.apply(b,arguments),this.cleanup=function(){if(b._logger=null,b._logBuffer=null,
        null!=b._sessionsByKey)for(var a=b._sessionsByKey.KeyValuePairs(),c=0;c<a.length;c++){var d=a[c],e=d.Value();e.cleanup()}b._sessionsByKey=null,b._nextSessionKey=0},this.newSessionKey=function(){var a=b._nextSessionKey;
        return b._nextSessionKey++,a},this.makeVideoSession=function(a){return b.makeSession(a,!1)},this.makeGlobalSession=function(a){return b.makeSession(a,!0)},this.buildGlobalSession=function(a,c,d){return new t(a,c,d,null,b._client,b._clientSettings,b._clientConfig,b._systemFactory);
    },this.buildVideoSession=function(a,c,d,e){return new t(a,c,d,e,b._client,b._clientSettings,b._clientConfig,b._systemFactory)},this.buildEventQueue=function(){return new x},this.generateSessionId=function(){
        return J.integer32()},this.buildMonitor=function(a,c,d){return new s(a,c,d,b._systemFactory)},this.makeSession=function(a,c){var e,f=d.ConstructClone(a),g=b.generateSessionId(),h=b.buildEventQueue();if(c)e=b.buildGlobalSession(g,h,f);else{
        var i=b.buildMonitor(g,h,f);e=b.buildVideoSession(g,h,f,i)}var j=b.newSessionKey();return b.addSession(j,e),e.start(),j},this.getSession=function(a){return b._sessionsByKey.ContainsKey(a)?b._sessionsByKey.GetValue(a):(b._logger.error("Client: invalid sessionKey. Did you cleanup that session previously?"),
        null)},this.getVideoSession=function(a){if(b._sessionsByKey.ContainsKey(a)){var c=b._sessionsByKey.GetValue(a);if(c.isVideoSession())return c}return b._logger.error("Client: invalid sessionKey. Did you cleanup that session previously?"),
        null},this.addSession=function(a,c){b._sessionsByKey.SetValue(a,c)},this.removeSession=function(a){b._sessionsByKey.Remove(a)},this.cleanupSession=function(a){var c=b.getSession(a);null!=c&&(b.removeSession(a),
        c.cleanup())}},v=a.CallbackWithTimeout=function(a){this._timer=a,this.getWrapperCallback=function(a,b,c){var d=!1,e=function(){d||(d=!0,a(!1,c+" ("+b+" ms)"))};this._timer.createOnce(e,b,"CallbackWithTimeout.wrap");
        var f=function(b,c){d||(d=!0,a(b,c))};return f}},w=a.Config=function(a,b,c,d,e){var f=this;this._logger=a,this._logger.setModuleName("Config"),this._storage=b,this._jsonInterface=c,this._callbackWithTimeout=d,
        this._systemSettings=e,this._defaultConfig={clientId:r.DEFAULT_CLIENT_ID,sendLogs:!1},this._config=G.ShallowCopy(this._defaultConfig),this._loaded=!1,this._waitingConsumers=[],this.isReady=function(){return this._loaded;
    },this.load=function(){var a=function(a,b){a?(f._parse(b),f._logger.debug("load(): configuration successfully loaded from local storage.")):f._logger.error("load(): error loading configuration from local storage: "+b),
        f._loaded=!0,f._notify()},b=this._callbackWithTimeout.getWrapperCallback(a,1e3*this._systemSettings.storageTimeout,"storage load timeout");this._storage.load(w.STORAGE_KEY,b)},this._parse=function(a){var b=this._jsonInterface.decode(a);
        if(null!=b&&this._config.clientId==r.DEFAULT_CLIENT_ID){var c=b[w.CONFIG_STORAGE_KEY_CLIENT_ID];null!=c&&c!=r.DEFAULT_CLIENT_ID&&""!=c&&"null"!=c&&(this._config.clientId=c,this._logger.info("parse(): setting the client id to "+c+" (from local storage)"));
        }},this._marshall=function(){var a={};return a[w.CONFIG_STORAGE_KEY_CLIENT_ID]=this._config.clientId,this._jsonInterface.encode(a)},this.save=function(){var a=function(a,b){a?f._logger.debug("save(): configuration successfully saved to local storage."):f._logger.error("save(): error saving configuration to local storage: "+b);
    },b=this._callbackWithTimeout.getWrapperCallback(a,1e3*this._systemSettings.storageTimeout,"storage save timeout");this._storage.save(w.STORAGE_KEY,this._marshall(),b)},this.register=function(a){return this.isReady()?void a():void this._waitingConsumers.push(a);
    },this.get=function(a){return this._loaded?this._config[a]:null},this.set=function(a,b){this._loaded&&(this._config[a]=b)},this._notify=function(){for(var a;null!=(a=this._waitingConsumers.pop());)a()};
    };w.STORAGE_KEY="sdkConfig",w.CONFIG_STORAGE_KEY_CLIENT_ID="clId";var x=a.EventQueue=function(){this._events=[],this._nextEventNumber=0,this.enqueue=function(a){this._events.push(a)},this.getNumber=function(){
        var a=this._nextEventNumber;return this._nextEventNumber++,a},this.flush=function(){var a=this._events;return this._events=[],a}},y=a.ExceptionCatcher=function(a,b,c){this._logger=a,this._logger.setModuleName("ExceptionCatcher"),
        this._ping=b,this._systemSettings=c,this.runProtected=function(a,b,c){try{b()}catch(d){if(null!=c)c(d);else{if(this._systemSettings.allowUncaughtExceptions)throw d;this.onUncaughtException(a,d)}}},this.onUncaughtException=function(a,b){
        try{this._ping.send("Uncaught exception: "+a+": "+b.toString())}catch(c){this._logger.error("Caught exception while sending ping: "+c.toString())}}},z=a.LogBuffer=function(){var a=32;this._buffer=[],this.add=function(b){
        this._buffer.length>=a&&this._buffer.shift(),this._buffer.push(b)},this.flush=function(){var a=this._buffer;return this._buffer=[],a}},A=a.Ping=function(a,c,d){this._isSendingPing=!1,this._cachedBasePingUrl=null,
        this._logger=a,this._logger.setModuleName("Ping"),this._httpClient=c,this._clientSettings=d,this.send=function(a){if(!this._isSendingPing){this._isSendingPing=!0;var b=this.getBasePingUrl()+"&d="+G.UrlEncodeString(a.toString());
        this._logger.error("send(): "+b),this._httpClient.request("GET",b,null,null,null),this._isSendingPing=!1}},this.getBasePingUrl=function(){if(!this._cachedBasePingUrl){var a=A.SERVICE_URL+"?comp="+A.COMPONENT_NAME+"&clv="+b.version;
        this._clientSettings&&(a+="&cid="+this._clientSettings.customerKey),a+="&sch="+r.SDK_METADATA_SCHEMA,this._clientSettings&&(this._cachedBasePingUrl=a)}return this._cachedBasePingUrl}};A.COMPONENT_NAME="sdkjs",
        A.SERVICE_URL="https://pings.conviva.com/ping.ping";var B=a.PlayerStates=function(){function a(){this.stateToInt=new E,this.stateToInt.SetValue(B.PLAYING,B.ePlaying),this.stateToInt.SetValue(B.STOPPED,B.eStopped),
        this.stateToInt.SetValue(B.PAUSED,B.ePaused),this.stateToInt.SetValue(B.BUFFERING,B.eBuffering),this.stateToInt.SetValue(B.NOT_MONITORED,B.eNotMonitored),this.stateToInt.SetValue(B.UNKNOWN,B.eUnknown)}
        var b=this;this.stateToInt=null,this.stringToInt=function(a){return this.stateToInt.ContainsKey(a)?this.stateToInt.GetValue(a):B.eUnknown},this.validString=function(a){return this.stateToInt.ContainsKey(a);
        },a.apply(b)},C=a.StreamerError=function(){function a(a,b){c.errorCode=a,c.severity=b}var c=this;c.errorCode=null,c.severity=b.ErrorSeverity.FATAL,a.apply(c,arguments)},D=a.ArrayCS=function(){function a(a){
        void 0===a&&(a=0),b.arr=new Array(a)}var b=this;b.arr=null,this.ToRepr=function(){return b.arr},this.Length=function(){return b.arr.length},this.GetValue=function(a){if(a>=b.arr.length)throw new Error("Index out of bounds: "+a+" (length "+b.arr.length+")");
        if(0>a)throw new Error("Index out of bounds: "+a);return b.arr[a]},this.SetValue=function(a,c){if(a>=b.arr.length)throw new Error("Index out of bounds: "+a+" (length "+b.arr.length+")");if(0>a)throw new Error("Index out of bounds: "+a);
        b.arr[a]=c},this.Values=function(){return b.arr},a.apply(this,arguments)};D.Create=function(){for(var a=new D,b=[],c=0;c<arguments.length;c++)b.push(arguments[c]);return a.arr=b,a},D.FromRepr=function(a){
        if(null==a)return null;var b=new D;return b.arr=a,b};var E=a.DictionaryCS=function(){function a(){b.obj={}}var b=this;b.obj=null,a.apply(this,arguments),this.ToObject=function(){return b.obj},this.GetValue=function(a){
        return b.obj[a]},this.SetValue=function(a,c){b.obj[a]=c},this.Clear=function(){G.forEachProp(b.obj,function(a){delete b.obj[a]})},this.ContainsKey=function(a){return void 0!==b.obj[a]},this.Keys=function(){
        var a=[];return G.forEachProp(b.obj,function(b){a.push(b)}),a},this.KeyValuePairs=function(){var a=[];return G.forEachProp(b.obj,function(c){a.push(new F(c,b.obj[c]))}),a},this.Add=this.SetValue,this.Remove=function(a){
        return b.ContainsKey(a)?(delete b.obj[a],!0):!1}};E.FromRepr=function(a){if(null==a)return null;if(a instanceof E)return a;a.hasOwnProperty("ToObject")&&(a=a.ToObject());var b=new E;return G.forEachProp(a,function(c){
        b.obj[c]=a[c]}),b},E.Create=function(){for(var a=new E,b=0;b+1<arguments.length;b+=2)a.obj[arguments[b]]=arguments[b+1];return a};var F=a.KeyValuePairCS=function(){function a(a,c){b.key=a,b.val=c}var b=this;
        b.key=null,b.val=null,a.apply(this,arguments),this.Value=function(){return b.val}},G=a.Lang=function(){};G.DictionaryFromRepr=function(a){var b=E.FromRepr(a);return b},G.StringDictionaryToRepr=function(a){
        return null==a?null:a.hasOwnProperty("ToObject")?a.ToObject():a},G.StringToInt=function(a){return parseInt(a)},G.ToString=function(a){return""+a},G.NumberToInt=function(a){return Math.floor(a)},G.NumberToUnsignedInt=function(a){
        return Math.abs(G.NumberToInt(a))},G.AsDouble=function(a){return Number(a)},G.AsBoolean=function(a){return Boolean(a)},G.isValidString=function(a){return"string"==typeof a&&""!==a},G.isBoolean=function(a){
        return"boolean"==typeof a},G.UrlEncodeString=function(a){return escape(a)},G.StringToIntSafe=function(a,b){var c=b;try{c=G.StringToInt(a)}catch(d){}return c},G.ShallowCopy=function(a){var b={};for(var c in a)b[c]=a[c];
        return b},G.ShallowCopyOmitNull=function(a){var b={};for(var c in a)null!=a[c]&&(b[c]=a[c]);return b},G.isArray=function(a){return a.constructor==Array?!0:"undefined"==typeof a.length?!1:!0},G.forEachProp=function(a,b){
        if(G.isArray(a))for(var c=0;c<a.length;c++)b(c);else for(var d in a)a.hasOwnProperty(d)&&b(d)},G.forEachPropValue=function(a,b){if(G.isArray(a))for(var c=0;c<a.length;c++)b(a[c]);else for(var d in a)a.hasOwnProperty(d)&&b(a[d]);
    },G.defGet=function(a,b,c){if("undefined"!=typeof Object.defineProperty)Object.defineProperty(a,b,{configurable:!0,enumerable:!0,get:c});else{if("undefined"==typeof a.__defineGetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineGetter__");
        a.__defineGetter__(b,c)}},G.defSet=function(a,b,c){if("undefined"!=typeof Object.defineProperty)Object.defineProperty(a,b,{configurable:!0,set:c});else{if("undefined"==typeof a.__defineSetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineSetter__");
        a.__defineSetter__(b,c)}},function(){var a={};a.two32=4294967296,a.uintRegex=new RegExp("^[0-9]+$"),a.MaxValue=a.two32-1,a.MinValue=0,G.sluint={},G.sluint.Cast=function(b){var c=parseInt(b);return c>a.MaxValue?c%=a.two32:0>c&&(c=-c%a.two32,
        c=a.two32-c),c};var b={};b.intRegex=new RegExp("^[+-]?[0-9]+$"),b.MaxValue=2147483647,b.MinValue=-2147483648,G.slint={},G.slint.Cast=function(c){var d=G.sluint.Cast(c);return d>b.MaxValue&&(d-=a.two32),
        d}}();var H=a.ListCS=function(){function a(){D.call(b,0)}var b=this;b.arr=null,this.ToRepr=function(){return b.arr},this.Add=function(a){b.arr.push(a)},this.Clear=function(a){b.arr.length=0},a.apply(this,arguments);
    },I=a.NativeLang=function(){};I.dictCount=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},I.setDictValue=function(a,b,c){a[b]=c},I.listCount=function(a){return a.length},I.GetField=function(a,b){
        return b[a]},I.GetStringField=function(a,b){var c=I.GetField(a,b);return c?c.toString():null};var J=a.Random=function(){};J.integer32=function(){return Math.floor(4294967295*Math.random())-2147483648},
        J.uinteger32=function(){return Math.floor(4294967295*Math.random())};var K=a.Sanitize={};K.Integer=function(a,b,c,d){if(isNaN(a))return d;if("number"!=typeof a)return d;if(a==d)return d;var e=G.NumberToInt(a);
        return K.EnforceBoundaries(e,b,c)},K.EnforceBoundaries=function(a,b,c){return null!=c&&a>c?a=c:null!=b&&b>a&&(a=b),a};var L=a.HttpClient=function(a,b,c){this._httpInterface=b,this._systemSettings=c,this.request=function(a,b,c,d,e){
        var f=1e3*this._systemSettings.httpTimeout;this._httpInterface.makeRequest(a,b,c,d,f,e)}},M=a.Logger=function(a,b,c,d,e){this._consoleInterface=a,this._timeInterface=b,this._settings=c,this._logBuffer=d,
        this._packageName=e,this.debug=function(a){this._settings.logLevel<=f.LogLevel.DEBUG&&this.log(a,f.LogLevel.DEBUG)},this.info=function(a){this._settings.logLevel<=f.LogLevel.INFO&&this.log(a,f.LogLevel.INFO);
    },this.warning=function(a){this._settings.logLevel<=f.LogLevel.WARNING&&this.log(a,f.LogLevel.WARNING)},this.error=function(a){this._settings.logLevel<=f.LogLevel.ERROR&&this.log(a,f.LogLevel.ERROR)},this.log=function(a,b){
        var c=this.formatMessage(a,b);this._logBuffer.add(c),this._consoleInterface.consoleLog(c,b)},this.prependModuleName=function(a){var b=a;return null!=this._moduleName&&""!=this._moduleName&&(b="["+this._moduleName+"] "+b),
        b},this.prependPackageName=function(a){var b=a;return null!=this._packageName&&""!=this._packageName&&(b="["+this._packageName+"] "+b),b},this.prependConvivaNamespace=function(a){var b=a;return null!=this._packageName&&""!=this._packageName&&(b="[Conviva] "+b),
        b},this.prependTime=function(a){var b=this._timeInterface.getEpochTimeMs(),c=(b/1e3).toFixed(3).toString();return"["+c+"] "+a},this.prependLogLevel=function(a,b){var c=M.getLogLevelString(b),d=a;return null!=this._packageName&&""!=this._packageName&&(d="["+c+"] "+d),
        d},this.prependSessionId=function(a){var b=a;return null!=this._sessionId&&(b="sid="+this._sessionId+" "+b),b},this.setSessionId=function(a){this._sessionId=a},this.setModuleName=function(a){this._moduleName=a;
    },this.formatMessage=function(a,b){return this.prependConvivaNamespace(this.prependTime(this.prependLogLevel(this.prependPackageName(this.prependModuleName(this.prependSessionId(a))),b)))}};M.getLogLevelString=function(a){
        var b;switch(a){case f.LogLevel.ERROR:b="ERROR";break;case f.LogLevel.WARNING:b="WARNING";break;case f.LogLevel.INFO:b="INFO";break;case f.LogLevel.DEBUG:b="DEBUG"}return b};var N=a.Storage=function(a){
        this._storageInterface=a,this.load=function(a,b){this._storageInterface.loadData(N.STORAGE_SPACE,a,b)},this.save=function(a,b,c){this._storageInterface.saveData(N.STORAGE_SPACE,a,b,c)}};N.STORAGE_SPACE="Conviva";
    var O=a.SystemMetadata=function(a,c){this._metadataInterface=a,this._exceptionCatcher=c,this._cachedMetadata=null,this.get=function(){return this._cachedMetadata||this.retrieve(),this._cachedMetadata},
        this.retrieve=function(){function a(a,b){d._exceptionCatcher.runProtected("Session.getSystemMetadataSchema(): "+a,function(){var c=b[a];b[a]=c()})}var c={};c[O.BROWSER_NAME]=this._metadataInterface.getBrowserName,
            c[O.BROWSER_VERSION]=this._metadataInterface.getBrowserVersion,c[O.DEVICE_BRAND]=this._metadataInterface.getDeviceBrand,c[O.DEVICE_MANUFACTURER]=this._metadataInterface.getDeviceManufacturer,c[O.DEVICE_MODEL]=this._metadataInterface.getDeviceModel,
            c[O.DEVICE_TYPE]=this._metadataInterface.getDeviceType,c[O.DEVICE_VERSION]=this._metadataInterface.getDeviceVersion,c[O.FRAMEWORK_NAME]=this._metadataInterface.getFrameworkName,c[O.FRAMEWORK_VERSION]=this._metadataInterface.getFrameworkVersion,
            c[O.OPERATING_SYSTEM_NAME]=this._metadataInterface.getOperatingSystemName,c[O.OPERATING_SYSTEM_VERSION]=this._metadataInterface.getOperatingSystemVersion;var d=this;for(var e in c)a(e,c),G.isValidString(c[e])||delete c[e];
            c[O.DEVICE_TYPE]!==b.DeviceType.DESKTOP&&c[O.DEVICE_TYPE]!==b.DeviceType.CONSOLE&&c[O.DEVICE_TYPE]!==b.DeviceType.SETTOP&&c[O.DEVICE_TYPE]!==b.DeviceType.MOBILE&&c[O.DEVICE_TYPE]!==b.DeviceType.TABLET&&c[O.DEVICE_TYPE]!==b.DeviceType.SMARTTV&&delete c[O.DEVICE_TYPE],
                this._cachedMetadata=G.ShallowCopyOmitNull(c)}};O.BROWSER_NAME="browserName",O.BROWSER_VERSION="browserVersion",O.DEVICE_BRAND="deviceBrand",O.DEVICE_MANUFACTURER="deviceManufacturer",O.DEVICE_MODEL="deviceModel",
        O.DEVICE_TYPE="deviceType",O.DEVICE_VERSION="deviceVersion",O.FRAMEWORK_NAME="frameworkName",O.FRAMEWORK_VERSION="frameworkVersion",O.OPERATING_SYSTEM_NAME="operatingSystemName",O.OPERATING_SYSTEM_VERSION="operatingSystemVersion";
    var P=a.Time=function(a){this._timeInterface=a,this.current=function(a){return this._timeInterface.getEpochTimeMs()}},Q=a.Timer=function(a,b){var c=this;this._timerInterface=a,this._exceptionCatcher=b,
        this.create=function(a,b,d){var e=function(){c._exceptionCatcher&&c._exceptionCatcher.runProtected(d,function(){a()})},f=this._timerInterface.createTimer(e,b,d);return f},this.createOnce=function(a,b,d){
        var e={cancel:null},f=function(){c._exceptionCatcher&&c._exceptionCatcher.runProtected(d,function(){"function"==typeof e.cancel&&(e.cancel(),e.cancel=null,e=null),a()})},g=this._timerInterface.createTimer(f,b,d);
        return e.cancel=g,g}}}(),Conviva.Client=a.Client,Conviva.ContentMetadata=a.ContentMetadata,Conviva.PlayerStateManager=a.PlayerStateManager,Conviva.SystemSettings=a.SystemSettings,Conviva.ClientSettings=a.ClientSettings,
    Conviva.SystemInterface=a.SystemInterface,Conviva.HttpInterface=a.HttpInterface,Conviva.TimeInterface=a.TimeInterface,Conviva.TimerInterface=a.TimerInterface,Conviva.LoggingInterface=a.LoggingInterface,
    Conviva.MetadataInterface=a.MetadataInterface,Conviva.StorageInterface=a.StorageInterface,Conviva.SystemFactory=a.SystemFactory}}();