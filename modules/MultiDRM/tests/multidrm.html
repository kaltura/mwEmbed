<!DOCTYPE HTML>
<html>
<head>
    <title> Multi DRM   </title>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="../../../mwEmbedLoader.php"></script>
</head>
<body>
<h3>Multi DRM</h3>
<p>
    Integration example for Kaltura player with multi DRM solution for enabling DASH playback on browser
</p>
<div id="videoTarget" style="width:600px;height:430px"></div>
<script>
    var jsonConfig  = {
        "plugins":{
            "topBarContainer": {},
            "titleLabel": {},
            "controlBarContainer": {
                "hover": true
            },
            "largePlayBtn": {},
            "scrubber": {
                'thumbSlicesUrl': '{mediaProxy.entryMetadata.thumbSlicesUrl}'
            },
            "vast":{
                "trackCuePoints":"true",
                "timeout": 4
            },
            'skipBtn': {
                'label': 'Skip Ad'
            },
            'noticeMessage': {
                'text': 'Advertisment {sequenceProxy.timeRemaining|timeFormat}'
            },
            "playPauseBtn": {},
            "volumeControl": {},
            "fullScreenBtn": {},
            "durationLabel": {},
            "currentTimeLabel": {},
            "sourceSelector": {},
            "logo": { "visible": false},
            "infoScreen": {},
            "share": {},
            "multidrm":{},
            'statistics': {'plugin': false}
        },
        "uiVars":[{
            "key":"autoPlay",
            "value":false,
            "overrideFlashvar":false
        }],
        "layout":{
            "skin": "kdark",
            "cssFiles":[]
        }
    };
    // per entry settings
    var mediaProxyKalturaEntryData = {
        'entry':{
            'id': "chromecast_debug",
            'name': "DRM Test",
            "description": "Kaltura Player DRM test entry",
            "plays": 1234,
            "views": 47332,
            "duration": 114,
            "createdAt": 1379965720,
            "thumbnailUrl": 'http://cdnbakmi.kaltura.com/p/243342/sp/24334200/thumbnail/entry_id/1_sf5ovm7u/version/100003/width/640'
        },
//        'entryCuePoints': [{
//            "protocolType": 1,
//            "adType": 1,
//            "cuePointType": "adCuePoint.Ad",
//            "startTime": 4936,
//            "sourceUrl": "http://projects.kaltura.com/mdale/hotelVastAd.xml"
//        }],
        "contextData": {
            'isCountryRestricted': false,
            'flavorCustomData': {
                a1: {},
                a2: {
                    "license":{
                        "custom_data": "eyJjYV9zeXN0ZW0iOiJPVFQiLCJ1c2VyX3Rva2VuIjoiMTIzNDU2IiwiYWNjb3VudF9pZCI6IjE0NyIsImNvbnRlbnRfaWQiOiJhbWlzaGFpX3Rlc3QiLCJmaWxlX2lkcyI6W10sInBsYXRmb3JtIjoiV2ViIn0=",
                        "signature": "WpnlZ7QC364kYR4z8QsUrEwqVd4%3D"
                    },
                    "contentId": "Fu9sZgv2Sni4Bl64NBNR/A=="
                },
                a3: {
                    "license":{
                        "custom_data": "eyJjYV9zeXN0ZW0iOiJPVFQiLCJ1c2VyX3Rva2VuIjoiMTIzNDU2IiwiYWNjb3VudF9pZCI6IjE0NyIsImNvbnRlbnRfaWQiOiJCaWdCdWNrQnVubnkiLCJmaWxlX2lkcyI6IiJ9",
                        "signature": "w0rD23ozL4u7Og/t2mXUaJvfjN0%3D"
                    },
                    "contentId": "TycikTMV90+oqZBlPwKFsg=="
                }
            }
        },
        'entryMetadata': {
            'thumbSlicesUrl': 'http://cdnbakmi.kaltura.com/p/243342/sp/24334200/thumbnail/entry_id/1_sf5ovm7u/version/100003/width/100/vid_slices/100',
            'AgeGroup': "16"
        },
        'sources': [
            //{
                //"src": "http://demo.castlabs.com/media/rio_enc/Manifest.mpd",
                //"width": "624",
                //"height": "352",
                //"bandwidth": "740352",
                //"type": "video/dash",
                //"assetid": "a1"
            //},
//            {
//                "src": "http://192.168.162.193/player/test/amishai_test.ism/manifest",
//                "type": "video/playreadySmooth",
//                "assetid": "a2"
//            },
            {
                "src": "http://52.17.80.196/dest/BigBuckBunny.ism/manifest", //http://192.168.162.193/player/bigbuckbunny/bigbuckbunny.ism/manifest"
                "type": "video/playreadySmooth",
                "assetid": "a3"
            }
        ]

    };
    mw.setConfig('forceMobileHTML5', true);
    kWidget.embed('videoTarget', {
        'wid' : '_partnerkey',
        'entry_id': 'chromecast_debug',
        'flashvars':{
            multiDrm: {
                "customData":{
                    "userId": "123456"
                },
                "widevineHeader": {
                    trackType: "SD_HD"
                },
                debug:true
            },
            "Kaltura.UdrmServerURL": "http://52.17.30.6/cenc/caslab/license/",
            "EmbedPlayer.clDashPlayerUrl": "http://projects.kaltura.com/OrenM/video.js",
            "EmbedPlayer.dashAsUrl": "http://projects.kaltura.com/OrenM/dashas/dashas.swf",
            "EmbedPlayer.dashJsUrl": "http://projects.kaltura.com/OrenM/cldasheverywhere.min.js",
            'jsonConfig':jsonConfig,
            // per entity settings:
            'mediaProxy': mediaProxyKalturaEntryData
        }
    });
</script>

</body>
</html>
