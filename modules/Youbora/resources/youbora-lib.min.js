/**
 * @license
 * youboralib 5.5.4 <http://youbora.com/>
 * Copyright NicePeopleAtWork <http://nicepeopleatwork.com/>
 */
var $YB=$YB||{version:"5.5.4",plugins:{},adnalyzers:{},utils:{},managers:{},comm:{},data:{}};$YB.comm.Communication=function(e,t){try{this.host=e,this.httpSecure=t,this.pingTime=5,this.prefix="U",this.code="",this.view=-1,this.preloaders=[],this._requests={},this.addPreloader("FastData")}catch(i){$YB.error(i)}},$YB.comm.Communication.prototype.extraOperationsCallback=null,$YB.comm.Communication.prototype.getViewCode=function(){return this.code?this.prefix+this.code+"_"+this.view:"nocode"},$YB.comm.Communication.prototype.nextView=function(e){return this.view++,e===!0?this.prefix="L":e===!1?this.prefix="V":this.prefix="U",this.getViewCode()},$YB.comm.Communication.prototype.requestData=function(e,t){try{e=e||{},e.outputformat="jsonp",e.requestNumber=Math.random(),delete e.code;var i=this,r=new $YB.comm.AjaxRequest(this._parseServiceHost(this.host),"/data",e);r.load(function(){i.receiveData(r)}),r.load(t),r.send(),$YB.noticeRequest("Request: NQS /data "+e.system)}catch(n){$YB.error(n)}},$YB.comm.Communication.prototype.receiveData=function(e){try{var t=e.getXHR(),i=t.response||t.responseText,r=JSON.parse(i.slice(i.indexOf("(")+1,i.lastIndexOf(")"))),n=r.q.h,s=r.q.c,a=r.q.pt,o=r.q.b;n.length>0&&s.length>0&&a.length>0&&o.length>0?(this.prefix=s.slice(0,1),this.code=s.slice(1),this.host=n,this.pingTime=a,this.balancerEnabled=o,$YB.noticeRequest("FastData '"+s+"' is ready."),this._requests.nocode&&this._requests.nocode.length>0&&(this._requests[this.getViewCode()]=this._requests.nocode,delete this._requests.nocode),this.removePreloader("FastData")):$YB.error("Error: FastData response is wrong.")}catch(d){$YB.error(d)}},$YB.comm.Communication.prototype.sendRequest=function(e,t,i){try{t=t||{},delete t.code;var r=new $YB.comm.AjaxRequest("",e,t);r.load(i),this._registerRequest(r)}catch(n){$YB.error(n)}},$YB.comm.Communication.prototype.sendService=function(e,t,i){try{var r=new $YB.comm.AjaxRequest(this._parseServiceHost(e),"",t);r.load(i),this._registerRequest(r)}catch(n){$YB.error(n)}},$YB.comm.Communication.prototype.addPreloader=function(e){try{this.preloaders.push(e)}catch(t){$YB.error(t)}},$YB.comm.Communication.prototype.removePreloader=function(e){try{var t=this.preloaders.indexOf(e);if(t!==-1){if(this.preloaders.splice(t,1),0===this.preloaders.length){var i;for(var r in this._requests)for(;i=this._requests[r].shift();)i.setParam("code",r),i.host||(i.host=this._parseServiceHost(this.host)),"function"==typeof this.extraOperationsCallback&&this.extraOperationsCallback(i.params),i.send()}}else $YB.warn("Warning: trying to remove unexisting preloader '"+e+"'.")}catch(n){$YB.error(n)}},$YB.comm.Communication.prototype._registerRequest=function(e){try{return"undefined"==typeof this._requests[this.getViewCode()]&&(this._requests[this.getViewCode()]=[]),e.setParam("timemark",(new Date).getTime()),this._requests[this.getViewCode()].push(e),this._sendRequests(),e}catch(t){$YB.error(t)}},$YB.comm.Communication.prototype._sendRequests=function(){try{if(0===this.preloaders.length){var e;for(var t in this._requests)for(;e=this._requests[t].shift();)e.setParam("code",t),e.host||(e.host=this._parseServiceHost(this.host)),e.send()}}catch(i){$YB.error(i)}},$YB.comm.Communication.prototype._parseServiceHost=function(e){try{return 0===e.indexOf("//")?e=e.slice(2):0===e.indexOf("http://")?e=e.slice(7):0===e.indexOf("https://")&&(e=e.slice(8)),e=this.httpSecure===!0?"https://"+e:0===window.location.protocol.indexOf("http")?"//"+e:"http://"+e}catch(t){return $YB.error(t),"http://localhost"}},$YB.comm.AjaxRequest=function(e,t,i,r){try{this.xhr=this.createXHR(),this.host=e,this.service=t||"",this.params=i,this.options=r||{},this.options.method=this.options.method||$YB.comm.AjaxRequest.options.method,this.options.maxRetries=this.options.maxRetries||$YB.comm.AjaxRequest.options.maxRetries,"undefined"==typeof this.options.retryAfter&&(this.options.retryAfter=$YB.comm.AjaxRequest.options.retryAfter),this.hasError=!1,this.retries=1}catch(n){$YB.error(n)}},$YB.comm.AjaxRequest.onEverySuccess=null,$YB.comm.AjaxRequest.options={method:"GET",requestHeaders:{},maxRetries:3,retryAfter:5e3},$YB.comm.AjaxRequest.prototype.getUrl=function(){try{return this.host+this.service+this.getParams()}catch(e){$YB.error(e)}},$YB.comm.AjaxRequest.prototype.getParams=function(){try{switch(typeof this.params){case"object":return"?"+this._parseParams(this.params);case"string":return this.params?"?"+this.params:"";default:return""}}catch(e){$YB.error(e)}},$YB.comm.AjaxRequest.prototype.setParam=function(e,t){try{switch(typeof this.params){case"string":this.params.length>0&&(this.params+="&"),this.params+=e+"="+t;break;case"object":default:this.params[e]=t}return this}catch(i){return $YB.error(i),this}},$YB.comm.AjaxRequest.prototype.on=function(e,t){try{"error"==e&&(this.hasError=!0),"function"==typeof t?this.xhr.addEventListener(e,t,!1):"undefined"!=typeof t&&$YB.warn("Warning: Request '"+this.getUrl()+"' has a callback that is not a function.")}catch(i){$YB.error(i)}finally{return this}},$YB.comm.AjaxRequest.prototype.load=function(e){return this.on("load",e)},$YB.comm.AjaxRequest.prototype.error=function(e){return this.on("error",e)},$YB.comm.AjaxRequest.prototype.send=function(){try{if(this.xhr.open(this.options.method,this.getUrl(),!0),this.options.requestHeaders)for(var e in this.options.requestHeaders)this.options.requestHeaders.hasOwnProperty(e)&&this.xhr.setRequestHeader(e,this.options.requestHeaders[e]);if(!this.hasError&&this.options.retryAfter>0&&this.options.maxRetries>0){var t=this;this.error(function(){if(t.retries>t.options.maxRetries)$YB.error("Error: Aborting failed request. Max retries reached.");else{$YB.warn("Error: Request "+t.service+" failed. Retry "+t.retries+" of "+t.options.maxRetries+" in "+t.options.retryAfter+"ms.");var e=t;setTimeout(function(){e.retries+=1,e.send()},t.options.retryAfter)}})}$YB.debugLevel>=5&&$YB.verbose("XHR Req: "+this.getUrl()),"function"==typeof $YB.comm.AjaxRequest.onEverySuccess&&this.load($YB.comm.AjaxRequest.onEverySuccess),this.xhr.send()}catch(i){$YB.error(i)}},$YB.comm.AjaxRequest.prototype.createXHR=function(){try{return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return $YB.error(e),{}}},$YB.comm.AjaxRequest.prototype.getXHR=function(){return this.xhr},$YB.comm.AjaxRequest.prototype._parseParams=function(e){try{if("string"==typeof e)return e;if(null!==e&&"object"==typeof e){var t="";for(var i in e)null!==e[i]&&"object"==typeof e[i]?t+=encodeURIComponent(i)+"="+encodeURIComponent(JSON.stringify(e[i]))+"&":null!==e[i]&&"undefined"!=typeof e[i]&&""!==e[i]&&(t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i])+"&");return t.slice(0,-1)}return""}catch(r){return $YB.error(r),""}},$YB.data.Options=function(e){try{this.setOptions(e)}catch(t){$YB.error(t)}},$YB.data.Options.prototype={enableAnalytics:!0,disabledRequests:[],parseHLS:!1,parseCDNNodeHost:!1,useCDNFromParser:!1,parseCDNNameFrom:"x-cdn-forward",haltOnError:!0,hashTitle:!0,httpSecure:void 0,enableNiceBuffer:!0,enableNiceSeek:!0,obfuscateIp:!1,enableInit:!1,accountCode:"nicetest",service:"nqs.nice264.com",username:void 0,transactionCode:void 0,network:{ip:void 0,isp:void 0},device:{id:void 0},media:{isLive:void 0,resource:void 0,title:void 0,duration:void 0,cdn:void 0,isBalanced:0,isResumed:0},ads:{expected:!1,resource:void 0,campaign:void 0,title:void 0,position:void 0,duration:void 0},properties:{contentId:void 0,type:void 0,transaction_type:void 0,genre:void 0,language:void 0,year:void 0,cast:void 0,director:void 0,owner:void 0,parental:void 0,price:void 0,rating:void 0,audioType:void 0,audioChannels:void 0,device:void 0,quality:void 0},extraParams:{param1:void 0,param2:void 0,param3:void 0,param4:void 0,param5:void 0,param6:void 0,param7:void 0,param8:void 0,param9:void 0,param10:void 0,param11:void 0,param12:void 0,param13:void 0,param14:void 0,param15:void 0,param16:void 0,param17:void 0,param18:void 0,param19:void 0,param20:void 0},setOptions:function(e,t){try{if(t=t||this,"undefined"!=typeof e)for(var i in e)"object"==typeof t[i]&&null!==t[i]?this.setOptions(e[i],t[i]):t[i]=e[i]}catch(r){$YB.error(r)}}},$YB.adnalyzers.Generic=function(){},$YB.adnalyzers.Generic.prototype={adnalyzerVersion:"5.3.0-GENERIC",ads:void 0,plugin:void 0},$YB.adnalyzers.Generic.prototype.startMonitoring=function(e,t){try{$YB.notice("Adnalyzer "+this.adnalyzerVersion+" is ready."),this.plugin=e,this.ads=t}catch(i){return $YB.error(i),null}},$YB.adnalyzers.Generic.prototype.stopMonitoring=function(){this.ads=null,this.plugin.viewManager.timer.adPlayheadMonitor.stop()},$YB.adnalyzers.Generic.prototype.enableAdBufferMonitor=function(){this.plugin.infoManager.options.enableNiceBuffer&&(this.plugin.viewManager.enableAdBufferMonitor=!0)},$YB.adnalyzers.Generic.prototype.enableAdSeekMonitor=function(){this.plugin.infoManager.options.enableNiceSeek&&(this.plugin.viewManager.enableAdSeekMonitor=!0)},$YB.adnalyzers.Generic.prototype.initAdHandler=function(){try{this.plugin.viewManager.isAdStartSent||this.plugin.viewManager.isAdInitSent||this.plugin.viewManager.sendAdInit()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.playAdHandler=function(){try{this.plugin.viewManager.isAdStartSent||this.plugin.viewManager.sendAdStart()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.startJoinAdHandler=function(){try{this.plugin.viewManager.isAdStartSent||(this.plugin.viewManager.sendAdStart(),this.plugin.viewManager.isBuffering&&(this.plugin.viewManager.chrono.joinTime.startTime=this.plugin.viewManager.chrono.buffer.startTime,this.plugin.viewManager.isBuffering=!1),this.plugin.viewManager.sendAdJoin())}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.joinAdHandler=function(){try{this.plugin.viewManager.sendAdJoin()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.pauseAdHandler=function(){try{this.plugin.viewManager.sendAdPause()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.pauseToggleAdHandler=function(){try{this.plugin.viewManager.isAdPaused?this.plugin.viewManager.sendAdResume():this.plugin.viewManager.sendAdPause()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.resumeAdHandler=function(){try{this.plugin.viewManager.sendAdResume()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.endedAdHandler=function(){try{this.plugin.viewManager.sendAdStop()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.skipAdHandler=function(){try{this.plugin.viewManager.sendAdStop({skipped:!0})}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.bufferingAdHandler=function(){try{this.plugin.viewManager.sendAdBufferStart()}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.bufferedAdHandler=function(){try{this.plugin.viewManager.isAdStartSent&&(this.plugin.viewManager.isAdJoinSent?this.plugin.viewManager.isAdBuffering&&this.plugin.viewManager.sendAdBufferEnd():this.plugin.viewManager.sendAdJoin())}catch(e){$YB.error(e)}},$YB.adnalyzers.Generic.prototype.errorAdHandler=function(e,t){try{"undefined"==typeof e&&(e=0),t=t||e||"Unknown error",this.plugin.viewManager.sendAdError({errorCode:e,msg:t})}catch(i){$YB.error(i)}},$YB.adnalyzers.Generic.prototype.noServedAdHandler=function(e,t){try{"undefined"==typeof e&&(e=0),t=t||e||"Unknown error",this.plugin.viewManager.sendAdError({errorCode:e,msg:t,errorSeverity:"AdsNotServed"}),this.plugin.viewManager.sendAdStop()}catch(i){$YB.error(i)}},$YB.adnalyzers.Generic.prototype.clickAdHandler=function(e){try{this.plugin.viewManager.sendAdClick({adUrl:e})}catch(t){$YB.error(t)}},$YB.adnalyzers.Generic.prototype.getAdResource=function(){return"unknown"},$YB.adnalyzers.Generic.prototype.getMediaPlayhead=function(){return null},$YB.adnalyzers.Generic.prototype.getAdPlayhead=function(){return 0},$YB.adnalyzers.Generic.prototype.getAdPosition=function(){return this.plugin.viewManager.isJoinSent?"mid":"pre"},$YB.adnalyzers.Generic.prototype.getAdTitle=function(){return null},$YB.adnalyzers.Generic.prototype.getAdDuration=function(){return 0},$YB.adnalyzers.Generic.prototype.getAdBitrate=function(){return-1},$YB.adnalyzers.Generic.prototype.getAdPlayerVersion=function(){return null},$YB.plugins.Generic=function(){},$YB.plugins.Generic.prototype={pluginName:"GENERIC",pluginVersion:"5.1.0-GENERIC",playerId:"generic",player:null,tag:null,infoManager:void 0,viewManager:void 0,adnalyzer:null},$YB.plugins.Generic.prototype.startMonitoring=function(e,t){try{$YB.notice("Plugin "+this.pluginVersion+" (with YouboraJS "+$YB.version+") is ready."),"string"==typeof e?(this.playerId=e,this.player=document.getElementById(e)):(this.player=e,e&&e.id&&(this.playerId=e.id)),this.tag=this.player,"undefined"==typeof this.infoManager?this.infoManager=new $YB.managers.Info(this,t):this.infoManager.setOptions(t),this.viewManager=new $YB.managers.View(this.infoManager)}catch(i){return $YB.error(i),null}},$YB.plugins.Generic.prototype.stopMonitoring=function(){this.player=null,this.tag=null,this.viewManager.stopTimers()},$YB.plugins.Generic.prototype.enableBufferMonitor=function(){this.infoManager.options.enableNiceBuffer&&(this.viewManager.enableBufferMonitor=!0)},$YB.plugins.Generic.prototype.enableSeekMonitor=function(){this.infoManager.options.enableNiceSeek&&(this.viewManager.enableSeekMonitor=!0)},$YB.plugins.Generic.prototype.setOptions=function(e){try{this.infoManager.options.setOptions(e)}catch(t){$YB.error(t)}},$YB.plugins.Generic.prototype.getOptions=function(){try{return this.infoManager.options||{}}catch(e){return $YB.error(e),{}}},$YB.plugins.Generic.prototype.playHandler=function(){try{this.viewManager.sendStart()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.joinHandler=function(){try{this.viewManager.sendJoin()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.playingHandler=function(){try{this.viewManager.isStartSent&&(this.viewManager.isJoinSent?this.viewManager.isSeeking&&this.viewManager.isPaused?(this.viewManager.sendSeekEnd(),this.viewManager.sendResume()):this.viewManager.isSeeking?this.viewManager.sendSeekEnd():this.viewManager.isBuffering?this.viewManager.sendBufferEnd():this.viewManager.isPaused&&this.viewManager.sendResume():this.viewManager.sendJoin())}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.pauseHandler=function(){try{this.viewManager.sendPause()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.pauseToggleHandler=function(){try{this.viewManager.isPaused?this.viewManager.sendResume():this.viewManager.sendPause()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.resumeHandler=function(){try{this.viewManager.sendResume()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.endedHandler=function(){try{this.viewManager.sendStop()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.errorHandler=function(e,t){try{"undefined"==typeof e&&(e=0),t=t||e||"Unknown error",this.viewManager.sendError({errorCode:e,msg:t})}catch(i){$YB.error(i)}},$YB.plugins.Generic.prototype.seekingHandler=function(){try{this.viewManager.isBuffering?this.viewManager.convertBufferToSeek():this.viewManager.sendSeekStart()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.seekedHandler=function(){try{this.viewManager.sendSeekEnd()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.bufferingHandler=function(){try{this.viewManager.isSeeking||this.viewManager.sendBufferStart()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.bufferedHandler=function(){try{this.viewManager.isStartSent&&(this.viewManager.isJoinSent?this.viewManager.isSeeking?this.viewManager.sendSeekEnd():this.viewManager.isBuffering&&this.viewManager.sendBufferEnd():this.viewManager.sendJoin())}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.ignoringAdHandler=function(){try{this.viewManager.sendIgnoreAdStart()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.ignoredAdHandler=function(){try{this.viewManager.sendIgnoreAdEnd()}catch(e){$YB.error(e)}},$YB.plugins.Generic.prototype.getResource=function(){return"unknown"},$YB.plugins.Generic.prototype.getPlayhead=function(){return 0},$YB.plugins.Generic.prototype.getMediaDuration=function(){return 0},$YB.plugins.Generic.prototype.getIsLive=function(){return!1},$YB.plugins.Generic.prototype.getRendition=function(){return null},$YB.plugins.Generic.prototype.getBitrate=function(){return-1},$YB.plugins.Generic.prototype.getThroughput=function(){if($YB.utils.getCdnTraffic()&&0!==$YB.utils.getCdnTraffic()){this.lastDataValue||(this.lastDataValue=0);var e=this.lastDataValue;return this.lastDataValue=$YB.utils.getCdnTraffic()+$YB.utils.getP2PTraffic(),Math.round((this.lastDataValue-e)/this.viewManager.comm.pingTime)}return-1},$YB.plugins.Generic.prototype.getPlayerVersion=function(){return null},$YB.plugins.Generic.prototype.getTotalBytes=function(){return null},$YB.plugins.Generic.prototype.getTitle=function(){return null},$YB.plugins.Generic.prototype.getCdnTraffic=function(){return $YB.utils.getCdnTraffic()},$YB.plugins.Generic.prototype.getP2PTraffic=function(){return $YB.utils.getP2PTraffic()},$YB.plugins.Generic.prototype.getUploadTraffic=function(){return $YB.utils.getUploadTraffic()},$YB.plugins.Generic.prototype.getIsP2PEnabled=function(){return $YB.utils.getIsP2PEnabled()},$YB.utils.Chrono=function(){try{this.startTime=0,this.lastTime=0}catch(e){$YB.error(e)}},$YB.utils.Chrono.prototype.getDeltaTime=function(e){try{return this.startTime?0===this.lastTime?e!==!1?this.stop():(new Date).getTime()-this.startTime:this.lastTime-this.startTime:-1}catch(t){$YB.error(t)}},$YB.utils.Chrono.prototype.start=function(){try{this.startTime=(new Date).getTime(),this.lastTime=0}catch(e){$YB.error(e)}},$YB.utils.Chrono.prototype.stop=function(){try{return this.lastTime=(new Date).getTime(),this.getDeltaTime()}catch(e){$YB.error(e)}},$YB.utils.parseNumber=function(e,t){return!isNaN(e)&&e>=0&&e!=1/0&&null!==e&&"undefined"!=typeof e?e:t},$YB.utils.listenAllEvents=function(e,t,i){try{if($YB.debugLevel>=4){i=i||function(e){var t="";"undefined"!=typeof e.target&&"undefined"!=typeof e.target.id&&(t=e.target.id),$YB.debug("Event: "+t+" > "+e.type)};var r=["canplay","buffering","waiting","ended","play","playing","pause","resume","error","abort","seek","seeking","seeked","stalled","dispose","loadeddata","loadstart"];t&&(null===t[0]?(t.shift(),r=t):r=r.concat(t));for(var n=0;n<r.length;n++)"function"==typeof e?e.call(window,r[n],i):e.on?e.on(r[n],i):e.addEventListener&&e.addEventListener(r[n],i)}}catch(s){$YB.error(s)}},$YB.utils.buildRenditionString=function(e,t,i){1==arguments.length&&(i=e,e=null,t=null);var r="";return e&&t&&(r=e+"x"+t,i>0&&(r+="@")),i<1?r:(i<1e3?r+=Math.round(i)+"bps":i<1e6?(i=Math.round(i/1e3),r+=i+"Kbps"):(i=Math.round(i/1e4)/100,r+=i+"Mbps"),r)},$YB.utils.getCdnTraffic=function(){if("undefined"!=typeof Streamroot&&Streamroot.p2pAvailable&&Streamroot.peerAgents){var e=0;for(agent in Streamroot.peerAgents)e+=Streamroot.peerAgents[agent].stats.cdn;return e}return"undefined"!=typeof peer5&&peer5.getStats?peer5.getStats().totalHttpDownloaded:null},$YB.utils.getP2PTraffic=function(){if("undefined"!=typeof Streamroot&&Streamroot.p2pAvailable&&Streamroot.peerAgents){var e=0;for(agent in Streamroot.peerAgents)Streamroot.peerAgents[agent].isP2PEnabled&&(e+=Streamroot.peerAgents[agent].stats.p2p);return e}return"undefined"!=typeof peer5&&peer5.getStats?peer5.getStats().totalP2PDownloaded:null},$YB.utils.getUploadTraffic=function(){if("undefined"!=typeof Streamroot&&Streamroot.p2pAvailable&&Streamroot.peerAgents){var e=0;for(agent in Streamroot.peerAgents)Streamroot.peerAgents[agent].isP2PEnabled&&(e+=Streamroot.peerAgents[agent].stats.upload);return e}return"undefined"!=typeof peer5&&peer5.getStats?peer5.getStats().totalP2PUploaded:null},$YB.utils.getIsP2PEnabled=function(){if("undefined"!=typeof Streamroot&&Streamroot.p2pAvailable&&Streamroot.peerAgents){var e=!1;for(agent in Streamroot.peerAgents)e=e||Streamroot.peerAgents[agent].isP2PEnabled;return e}return!("undefined"==typeof peer5||!peer5.getStats)||null},$YB.debugLevel=2,$YB.messageLevels={1:"e",2:"w",3:"n",4:"d",5:"v"},$YB.plainConsole=!1,$YB.report=function(e,t,i){if(console&&console.log){t=t||4,i=i||"darkcyan";var r=$YB.messageLevels[t],n=$YB.getCurrentTime()+"[Youbora] "+r+":";if("undefined"!=typeof $YB.remoteLog&&$YB.remoteLog.enabled===!0&&$YB.remoteLog(n+e),$YB.debugLevel>=t)if($YB.plainConsole||document.documentMode)$YB.plainReport(e,n);else{var s=console.log;1==t&&console.error?s=console.error:2==t&&console.warn?s=console.warn:t>=4&&console.debug&&(s=console.debug),n="%c"+n,e instanceof Array?(e.splice(0,0,n,"color: "+i),s.apply(console,e)):s.call(console,n,"color: "+i,e)}}},$YB.getCurrentTime=function(e){var t=new Date;return"["+("0"+t.getDate()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)+"."+("00"+t.getMilliseconds()).slice(-3)+"]"},$YB.plainReport=function(e,t){if(e instanceof Array)for(var i in e)$YB.plainReport(e[i],t);else"string"==typeof e?console.log(t+" "+e):(console.log(t+" <next line>"),console.log(e))},$YB.error=function(){$YB.report([].slice.call(arguments),1,"darkred")},$YB.warn=function(){$YB.report([].slice.call(arguments),2,"darkorange")},$YB.notice=function(){$YB.report([].slice.call(arguments),3,"darkcyan")},$YB.noticeRequest=function(){$YB.report([].slice.call(arguments),3,"darkgreen")},$YB.debug=function(){$YB.report([].slice.call(arguments),4,"indigo")},$YB.verbose=function(){$YB.report([].slice.call(arguments),5,"navy")},function(){function e(e){switch(e){case"plain":$YB.plainConsole=!0;break;case"remote":$YB.remoteLog.forced=!0;break;case"plain+remote":case"remote+plain":$YB.remoteLog.forced=!0,$YB.plainConsole=!0}}try{if("undefined"!=typeof window){var t=document.getElementsByTagName("script");for(var i in t)if(t[i].getAttribute){var r=t[i].getAttribute("youbora-debug");r&&($YB.debugLevel=r),r=t[i].getAttribute("youbora-console"),r&&e(r)}var n=/\?.*\&*youbora-debug=(.+)/i.exec(window.location.search);null!==n&&($YB.debugLevel=n[1]),n=/\?.*\&*youbora-console=(.+)/i.exec(window.location.search),null!==n&&e(n[1])}}catch(s){$YB.error(s)}}(),$YB.utils.ResourceParser=function(e){try{this.viewManager=e,this.parseTimeout=null,this.realResource="",this.nodeHost=void 0,this.nodeType=void 0,this.cdn,this.cdnRequests={},this.cdns=$YB.utils.ResourceParser.cdnsEnabled.slice()}catch(t){$YB.error(t)}},$YB.utils.ResourceParser.prototype.init=function(){try{this.realResource&&this.clear(),this.viewManager.comm.addPreloader("ResourceParser");var e=this;this.viewManager.comm.extraOperationsCallback=function(t){"undefined"!=typeof t.resource&&e.realResource&&(t.resource=e.realResource),"undefined"!=typeof t.nodeHost&&e.nodeHost&&(t.nodeHost=e.nodeHost,t.nodeType=e.nodeType),!t.cdn&&e.viewManager.infoManager.options.useCDNFromParser&&(t.cdn=e.cdn)},this.parseTimeout=setTimeout(function(){"ResourceParser"in e.viewManager.comm.preloaders&&(e.realResource=e.viewManager.infoManager.getResource(),e.viewManager.comm.removePreloader("ResourceParser"),$YB.warn("ResourceParser has exceded the maximum execution time (3s) and will be aborted."))},3e3),this.realResource=this.viewManager.infoManager.getResource(),this.viewManager.infoManager.options.parseHLS?this._parseRealResourceAsync(this.realResource):this._parseCDNAsync()}catch(t){$YB.error(t)}},$YB.utils.ResourceParser.prototype.clear=function(){this.realResource="",this.nodeHost=void 0,this.nodeType=void 0,this.cdnRequests={},this.cdns=$YB.utils.ResourceParser.cdnsEnabled.slice()},$YB.utils.ResourceParser.prototype._parseRealResourceAsync=function(e,t){try{var i=/(\S*?(\.m3u8|\.m3u|\.ts|\.mp4)(\?\S*|\n|\r|$))/i.exec(e);if(null!==i){var r=i[1].trim();if(0!==r.indexOf("http")&&0!==r.indexOf("//")&&(r=t.slice(0,t.lastIndexOf("/"))+"/"+r),".m3u8"==i[2]||".m3u"==i[2]){var n=this;new $YB.comm.AjaxRequest(r).load(function(){n._parseRealResourceAsync(this.responseText,r)}).error(function(){n._parseCDNAsync()}).send()}else this.realResource=r,this._parseCDNAsync()}else this._parseCDNAsync()}catch(s){$YB.error(s),this._parseCDNAsync()}},$YB.utils.ResourceParser.cdnsEnabled=["Level3","Akamai","Highwinds","Fastly"],$YB.utils.ResourceParser.cdnsAvailable={Level3:{code:"LEVEL3",parsers:[{type:"host+type",name:"X-WR-DIAG",regex:/Host:(.+)\sType:(.+)/}],headers:{"X-WR-DIAG":"host"}},Akamai:{code:"AKAMAI",parsers:[{type:"host+type",name:"X-Cache",regex:/(.+)\sfrom\s.+\(.+\/(.+)\).+/}]},Highwinds:{code:"HIGHNEGR",parsers:[{type:"host+type",name:"X-HW",regex:/.+,[0-9]+\.(.+)\.(.+)/}]},Fastly:{code:"FASTLY",parsers:[{type:"host",name:"X-Served-By",regex:/([^,\s]+)$/},{type:"type",name:"X-Cache",regex:/([^,\s]+)$/}]},Telefonica:{code:"TELEFO",parsers:[{type:"host+type",name:"X-TCDN",regex:/Host:(.+)\sType:(.+)/}]},CustomCDN:{code:null,parsers:[{type:"name",regex:/(.+)/}]}},$YB.utils.ResourceParser.prototype._parseCDNAsync=function(){try{if(this.viewManager.infoManager.options.parseCDNNodeHost)if(this.cdns.length>0&&!this.nodeHost){var e=this.cdns.shift();if("undefined"!=typeof $YB.utils.ResourceParser.cdnsAvailable[e]){var t=$YB.utils.ResourceParser.cdnsAvailable[e],i=JSON.stringify(t.headers);if(this.cdnRequests.hasOwnProperty(i))this._parseNode(t,this.cdnRequests[i]);else{var r=this,n=new $YB.comm.AjaxRequest(this.realResource,"","",{method:"HEAD",maxRetries:0,requestHeaders:t.headers});n.load(function(){r.cdnRequests[i]=n.getXHR(),r._parseNode(t,n.getXHR())}),n.error(function(){r._parseCDNAsync()}),n.send()}}else this._parseCDNAsync()}else this.viewManager.comm.removePreloader("ResourceParser");else this.viewManager.comm.removePreloader("ResourceParser")}catch(s){$YB.error(s)}},$YB.utils.ResourceParser.prototype._parseNode=function(e,t){try{var i=e.parsers;for(var r in i){"name"==i[r].type&&(i[r].name=this.viewManager.infoManager.options.parseCDNNameFrom);var n=t.getResponseHeader(i[r].name);if(null===n)return void this._parseCDNAsync();var s=i[r].regex.exec(n);if(null===s)return void this._parseCDNAsync();switch(i[r].type){case"host":this.nodeHost=s[1];break;case"type":this.nodeType=this._parseNodeType(s[1]);break;case"host+type":this.nodeHost=s[1],this.nodeType=this._parseNodeType(s[2]);break;case"type+host":this.nodeType=this._parseNodeType(s[1]),this.nodeHost=s[2];break;case"name":this.cdn=s[1].toUpperCase()}e.code&&(this.cdn=e.code)}this._parseCDNAsync()}catch(a){$YB.error(a),this._parseCDNAsync()}},$YB.utils.ResourceParser.prototype._parseNodeType=function(e){try{switch(e){case"TCP_HIT":case"HIT":case"c":return 1;case"TCP_MISS":case"MISS":case"p":case"i":case"m":return 2;case"TCP_MEM_HIT":return 3;case"TCP_IMS_HIT":return 4;default:return 0}}catch(t){return $YB.error(t),0}},$YB.utils.Timer=function(e,t){try{this.callback=e,this.interval=t||5e3,this.isRunning=!1,this.timer=null,this.chrono=new $YB.utils.Chrono}catch(i){$YB.error(i)}},$YB.utils.Timer.prototype.start=function(){try{this.isRunning=!0,this._setPing()}catch(e){$YB.error(e)}},$YB.utils.Timer.prototype.stop=function(){try{this.isRunning=!1,clearTimeout(this.timer)}catch(e){$YB.error(e)}},$YB.utils.Timer.prototype._setPing=function(){try{if(this.isRunning){this.chrono.start();var e=this;this.timer=setTimeout(function(){e.callback(e.chrono.stop()),e._setPing()},this.interval)}}catch(t){$YB.error(t)}},$YB.managers.Info=function(e,t){this.plugin=e,this.options=new $YB.data.Options(t),this.lastBitrate=0,this.lastAdBitrate=0},$YB.managers.Info.prototype.getDataParams=function(e){try{return e=e||{},e.system=e.hasOwnProperty("system")?e.system:this.options.accountCode,e.pluginName=e.hasOwnProperty("pluginName")?e.pluginName:this.plugin.pluginName,e.pluginVersion=e.hasOwnProperty("pluginVersion")?e.pluginVersion:this.plugin.pluginVersion,e.live=e.hasOwnProperty("live")?e.live:this.options.media.isLive,e}catch(t){return $YB.error(t),e}},$YB.managers.Info.prototype.setOptions=function(e){this.options.setOptions(e)},$YB.managers.Info.prototype.getOptions=function(e){return this.options},$YB.managers.Info.prototype.getAdPlayhead=function(){try{return this.plugin.adnalyzer?$YB.utils.parseNumber(this.plugin.adnalyzer.getAdPlayhead(),0):0}catch(e){return $YB.warn(e),0}},$YB.managers.Info.prototype.getAdBitrate=function(){try{if(this.plugin.adnalyzer){var e=Math.round(this.plugin.adnalyzer.getAdBitrate());if(e==-1&&this.plugin.adnalyzer.tag&&"undefined"!=typeof this.plugin.adnalyzer.tag.webkitVideoDecodedByteCount){var t=this.plugin.adnalyzer.tag.webkitVideoDecodedByteCount;if(this.lastAdBitrate){var i=5;this.plugin.viewManager&&this.plugin.viewManager.comm&&this.plugin.viewManager.comm.pingTime&&(i=this.plugin.viewManager.comm.pingTime),t=Math.round((this.plugin.adnalyzer.tag.webkitVideoDecodedByteCount-this.lastAdBitrate)/i*8)}this.lastAdBitrate=this.plugin.adnalyzer.tag.webkitVideoDecodedByteCount,e=t}return $YB.utils.parseNumber(e,-1)}return-1}catch(r){return $YB.warn(r),-1}},$YB.managers.Info.prototype.getAdResource=function(){try{return"undefined"!=typeof this.options.ads.resource?this.options.ads.resource:this.plugin.adnalyzer.getAdResource()}catch(e){return $YB.warn(e),""}},$YB.managers.Info.prototype.getAdPosition=function(){try{return"undefined"!=typeof this.options.ads.position?this.options.ads.position:this.plugin.adnalyzer.getAdPosition()}catch(e){return $YB.warn(e),"mid"}},$YB.managers.Info.prototype.getAdTitle=function(){try{return"undefined"!=typeof this.options.ads.title?this.options.ads.title:this.plugin.adnalyzer.getAdTitle()}catch(e){return $YB.warn(e),""}},$YB.managers.Info.prototype.getAdDuration=function(){try{var e=0;return e="undefined"!=typeof this.options.ads.duration?this.options.ads.duration:Math.round(this.plugin.adnalyzer.getAdDuration()),$YB.utils.parseNumber(e,0)}catch(t){return $YB.warn(t),0}},$YB.managers.Info.prototype.getAdPlayerVersion=function(){try{return this.plugin.adnalyzer.getAdPlayerVersion()}catch(e){return $YB.warn(e),null}},$YB.managers.Info.prototype.getAdStartParams=function(e,t){try{return e=e||{},e.position="undefined"!=typeof e.position?e.position:this.getAdPosition(),e.resource="undefined"!=typeof e.resource?e.resource:this.getAdResource(),e.campaign="undefined"!=typeof e.campaign?e.campaign:this.options.ads.campaign,e.title="undefined"!=typeof e.title?e.title:this.getAdTitle(),e.adDuration="undefined"!=typeof e.adDuration?e.adDuration:this.getAdDuration(),e.playhead="undefined"!=typeof e.playhead?e.playhead:Math.round(this.getPlayhead()),e.adnalyzerVersion="undefined"!=typeof e.adnalyzerVersion?e.adnalyzerVersion:this.plugin.adnalyzer.adnalyzerVersion,e.adPlayerVersion="undefined"!=typeof e.adPlayerVersion?e.adPlayerVersion:this.getAdPlayerVersion(),e}catch(i){return $YB.error(i),e}},$YB.managers.Info.prototype.getAdJoinParams=function(e,t){try{return e=e||{},e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:this.getAdPlayhead(),e.playhead=this.getPlayhead()?Math.round(this.getPlayhead()):void 0,e}catch(i){return $YB.error(i),e}},$YB.managers.Info.prototype.getAdStopParams=function(e,t){try{return e=e||{},e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:Math.round(this.getAdPlayhead()),e.adBitrate="undefined"!=typeof e.adBitrate?e.adBitrate:this.getAdBitrate(),e.playhead=this.getPlayhead()?Math.round(this.getPlayhead()):void 0,e}catch(i){return $YB.error(i),e}},$YB.managers.Info.prototype.getAdPauseParams=function(e,t){return e||(e={}),this.getAdPlayhead&&this.getAdPlayhead()&&(e.adPlayhead=Math.round(this.getAdPlayhead())),e.playhead=this.getPlayhead()?Math.round(this.getPlayhead()):void 0,e},$YB.managers.Info.prototype.getAdResumeParams=function(e,t){return e||(e={}),this.getAdPlayhead&&this.getAdPlayhead()&&(e.adPlayhead=Math.round(this.getAdPlayhead())),e.playhead=this.getPlayhead()?Math.round(this.getPlayhead()):void 0,e},$YB.managers.Info.prototype.getAdBufferEndParams=function(e,t){try{return e=e||{},e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:Math.round(this.getAdPlayhead()),e.playhead=this.getPlayhead()?Math.round(this.getPlayhead()):void 0,e}catch(i){return $YB.error(i),e}},$YB.managers.Info.prototype.getAdPingParams=function(e,t){try{
return e=e||{},e.adBitrate="undefined"!=typeof e.adBitrate?e.adBitrate:this.getAdBitrate(),e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:Math.round(this.getAdPlayhead()),e.playhead=this.getPlayhead()?Math.round(this.getPlayhead()):void 0,e}catch(i){return $YB.error(i),e}},$YB.managers.Info.prototype.getAdErrorParams=function(e,t){try{return e=e||{},e.errorCode=e.hasOwnProperty("errorCode")?e.errorCode:"9000",e.msg=e.hasOwnProperty("msg")?e.msg:"Unknown Error",e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:Math.round(this.getAdPlayhead()),e.playhead=this.getPlayhead()?Math.round(this.getPlayhead()):void 0,e.player=e.hasOwnProperty("player")?e.player:this.plugin.pluginName,e}catch(i){return $YB.error(i),e}},$YB.managers.Info.prototype.getAdClickParams=function(e,t){try{return e=e||{},e.adPlayhead="undefined"!=typeof e.adPlayhead?e.adPlayhead:Math.round(this.getAdPlayhead()),e.playhead=this.getPlayhead()?Math.round(this.getPlayhead()):void 0,e}catch(i){return $YB.error(i),e}},$YB.managers.Info.prototype.getResource=function(){try{return this.plugin.viewManager.resourceParser&&this.plugin.viewManager.resourceParser.realResource?this.plugin.viewManager.resourceParser.realResource:"undefined"!=typeof this.options.media.resource?this.options.media.resource:this.plugin.getResource()}catch(e){return $YB.warn(e),"unknown"}},$YB.managers.Info.prototype.getCDN=function(){try{return this.plugin.viewManager.resourceParser&&this.plugin.viewManager.resourceParser.cdn&&this.options.useCDNFromParser?this.plugin.viewManager.resourceParser.cdn:"undefined"!=typeof this.options.media.cdn?this.options.media.cdn:null}catch(e){return $YB.warn(e),null}},$YB.managers.Info.prototype.getMediaDuration=function(){try{var e=0;return e="undefined"!=typeof this.options.media.duration?this.options.media.duration:this.plugin.getMediaDuration(),Math.round($YB.utils.parseNumber(e,0))}catch(t){return $YB.warn(t),0}},$YB.managers.Info.prototype.getIsLive=function(){try{return"undefined"!=typeof this.options.media.isLive?this.options.media.isLive:this.plugin.getIsLive()}catch(e){return $YB.warn(e),!1}},$YB.managers.Info.prototype.getPlayerVersion=function(){try{return this.plugin.getPlayerVersion()}catch(e){return $YB.warn(e),""}},$YB.managers.Info.prototype.getTitle=function(){try{return"undefined"!=typeof this.options.media.title?this.options.media.title:this.plugin.getTitle()}catch(e){return $YB.warn(e),""}},$YB.managers.Info.prototype.getRendition=function(){try{return"undefined"!=typeof this.options.media.rendition?this.options.media.rendition:this.plugin.getRendition()}catch(e){return $YB.warn(e),""}},$YB.managers.Info.prototype.getBitrate=function(){try{var e=Math.round(this.plugin.getBitrate());if(e==-1&&this.plugin.tag&&"undefined"!=typeof this.plugin.tag.webkitVideoDecodedByteCount){var t=this.plugin.tag.webkitVideoDecodedByteCount;if(this.lastBitrate){var i=5;this.plugin.viewManager&&this.plugin.viewManager.comm&&this.plugin.viewManager.comm.pingTime&&(i=this.plugin.viewManager.comm.pingTime),t=Math.round((this.plugin.tag.webkitVideoDecodedByteCount-this.lastBitrate)/i*8)}this.lastBitrate=this.plugin.tag.webkitVideoDecodedByteCount,e=0!=t?t:-1}return $YB.utils.parseNumber(e,-1)}catch(r){return $YB.warn(r),-1}},$YB.managers.Info.prototype.getThroughput=function(){try{return $YB.utils.parseNumber(Math.round(this.plugin.getThroughput()),-1)}catch(e){return $YB.warn(e),-1}},$YB.managers.Info.prototype.getTotalBytes=function(){try{return $YB.utils.parseNumber(this.plugin.getTotalBytes(),null)}catch(e){return $YB.warn(e),null}},$YB.managers.Info.prototype.getPlayhead=function(){try{var e=this.plugin.getPlayhead();return this.plugin.adnalyzer&&null!==this.plugin.adnalyzer.getMediaPlayhead()&&(e=this.plugin.adnalyzer.getMediaPlayhead()),$YB.utils.parseNumber(e,0)}catch(t){return $YB.warn(t),0}},$YB.managers.Info.prototype.getStartParams=function(e){try{if(e=e||{},e.system=e.hasOwnProperty("system")?e.system:this.options.accountCode,e.player=e.hasOwnProperty("player")?e.player:this.plugin.pluginName,e.user=e.hasOwnProperty("user")?e.user:this.options.username,e.transcode=e.hasOwnProperty("transcode")?e.transcode:this.options.transactionCode,e.hashTitle=e.hasOwnProperty("hashTitle")?e.hashTitle:this.options.hashTitle,!e.hasOwnProperty("referer")){e.referer="";try{e.referer=top.window.location.href}catch(t){e.referer=window.location.href}}return this.options.obfuscateIp&&(e.obfuscateIp=!0),e.deviceId=e.hasOwnProperty("deviceId")?e.deviceid:this.options.device.id,e.pluginVersion=e.hasOwnProperty("pluginVersion")?e.pluginVersion:this.plugin.pluginVersion,e.playerVersion=e.hasOwnProperty("playerVersion")?e.playerVersion:this.getPlayerVersion(),e.resource=e.hasOwnProperty("resource")?e.resource:this.getResource(),e.duration=e.hasOwnProperty("duration")?e.duration:this.getMediaDuration(),e.live=e.hasOwnProperty("live")?e.live:this.getIsLive(),e.rendition=e.hasOwnProperty("rendition")?e.rendition:this.getRendition(),e.title=e.hasOwnProperty("title")?e.title:this.getTitle(),e.properties=e.hasOwnProperty("properties")?e.properties:this.options.properties,e.cdn=e.hasOwnProperty("cdn")?e.cdn:this.getCDN(),e.isp=e.hasOwnProperty("isp")?e.isp:this.options.network.isp,e.ip=e.hasOwnProperty("ip")?e.ip:this.options.network.ip,e.param1=e.hasOwnProperty("param1")?e.param1:this.options.extraParams.param1,e.param2=e.hasOwnProperty("param2")?e.param2:this.options.extraParams.param2,e.param3=e.hasOwnProperty("param3")?e.param3:this.options.extraParams.param3,e.param4=e.hasOwnProperty("param4")?e.param4:this.options.extraParams.param4,e.param5=e.hasOwnProperty("param5")?e.param5:this.options.extraParams.param5,e.param6=e.hasOwnProperty("param6")?e.param6:this.options.extraParams.param6,e.param7=e.hasOwnProperty("param7")?e.param7:this.options.extraParams.param7,e.param8=e.hasOwnProperty("param8")?e.param8:this.options.extraParams.param8,e.param9=e.hasOwnProperty("param9")?e.param9:this.options.extraParams.param9,e.param10=e.hasOwnProperty("param10")?e.param10:this.options.extraParams.param10,e.param11=e.hasOwnProperty("param11")?e.param11:this.options.extraParams.param11,e.param12=e.hasOwnProperty("param12")?e.param12:this.options.extraParams.param12,e.param13=e.hasOwnProperty("param13")?e.param13:this.options.extraParams.param13,e.param14=e.hasOwnProperty("param14")?e.param14:this.options.extraParams.param14,e.param15=e.hasOwnProperty("param15")?e.param15:this.options.extraParams.param15,e.param16=e.hasOwnProperty("param16")?e.param16:this.options.extraParams.param16,e.param17=e.hasOwnProperty("param17")?e.param17:this.options.extraParams.param17,e.param18=e.hasOwnProperty("param18")?e.param18:this.options.extraParams.param18,e.param19=e.hasOwnProperty("param19")?e.param19:this.options.extraParams.param19,e.param20=e.hasOwnProperty("param20")?e.param20:this.options.extraParams.param20,e.totalBytes=e.hasOwnProperty("totalBytes")?e.totalBytes:this.getTotalBytes(),1==this.options.isResumed&&(e.isResumed=1),1==this.options.isBalanced&&(e.isBalanced=1),e}catch(i){return $YB.error(i),e}},$YB.managers.Info.prototype.getJoinParams=function(e){try{return e=e||{},e.eventTime=e.hasOwnProperty("eventTime")?e.eventTime:this.getPlayhead(),e.mediaDuration=e.hasOwnProperty("mediaDuration")?e.mediaDuration:this.getMediaDuration(),e}catch(t){return $YB.error(t),e}},$YB.managers.Info.prototype.getStopParams=function(e){return e||{}},$YB.managers.Info.prototype.getPauseParams=function(e){return e||(e={}),this.getPlayhead&&this.getPlayhead()&&(e.playhead=Math.round(this.getPlayhead())),e},$YB.managers.Info.prototype.getResumeParams=function(e){return e||(e={}),this.getPlayhead&&this.getPlayhead()&&(e.playhead=Math.round(this.getPlayhead())),e},$YB.managers.Info.prototype.getBufferEndParams=function(e){try{return e=e||{},e.time=e.hasOwnProperty("time")?e.time:this.getPlayhead(),e}catch(t){return $YB.error(t),e}},$YB.managers.Info.prototype.getErrorParams=function(e){try{return e=e||{},this.plugin.viewManager.isJoinSent||e.errorType&&"fatal"===e.errorType&&(e.errorType=void 0),e.errorCode=e.hasOwnProperty("errorCode")?e.errorCode:"9000",e.msg=e.hasOwnProperty("msg")?e.msg:"Unknown Error",e=this.getStartParams(e)}catch(t){return $YB.error(t),e}},$YB.managers.Info.prototype.getSeekEndParams=function(e){return this.getBufferEndParams(e)},$YB.managers.Info.prototype.getPingParams=function(e,t){try{return e=e||{},e.time="undefined"!=typeof e.time?e.time:this.getPlayhead(),e.bitrate="undefined"!=typeof e.bitrate?e.bitrate:this.getBitrate(),e.throughput="undefined"!=typeof e.throughput?e.throughput:this.getThroughput(),e.totalBytes="undefined"!=typeof e.totalBytes?e.totalBytes:this.getTotalBytes(),"undefined"!=typeof this.plugin.getCdnTraffic&&"undefined"!=typeof this.plugin.getP2PTraffic&&(this.plugin.getCdnTraffic()||this.plugin.getP2PTraffic())&&(e.cdnDownloadedTraffic=this.plugin.getCdnTraffic(),e.p2pDownloadedTraffic=this.plugin.getP2PTraffic(),e.uploadTraffic=this.plugin.getUploadTraffic()),e}catch(i){return $YB.error(i),e}},$YB.managers.View=function(e){this.infoManager=e,this.isStartSent=!1,this.isInitSent=!1,this.isJoinSent=!1,this.isPaused=!1,this.isSeeking=!1,this.isBuffering=!1,this.isErrorSent=!1,this.isShowingAds=!1,this.isAdStartSent=!1,this.isAdJoinSent=!1,this.isAdPaused=!1,this.isAdBuffering=!1,this.chrono={joinTime:new $YB.utils.Chrono,seek:new $YB.utils.Chrono,pause:new $YB.utils.Chrono,buffer:new $YB.utils.Chrono,adIgnore:new $YB.utils.Chrono,adTotal:new $YB.utils.Chrono,adJoinTime:new $YB.utils.Chrono,adPause:new $YB.utils.Chrono,adBuffer:new $YB.utils.Chrono},this.adCounter={pre:0,mid:0,post:0,unknown:0};var t=this;this.timer={pinger:new $YB.utils.Timer(function(e){t.sendPing({diffTime:e})}),playheadMonitor:new $YB.utils.Timer(function(e){t.checkPlayhead()},$YB.managers.View.monitoringInterval),adPlayheadMonitor:new $YB.utils.Timer(function(e){t.checkAdPlayhead()},$YB.managers.View.monitoringInterval)},this.enableBufferMonitor=!1,this.enableSeekMonitor=!1,this.enableAdBufferMonitor=!1,this.enableAdSeekMonitor=!1,this.lastDuration=0,this.lastPlayhead=0,this.lastAdPosition="",this.lastRendition="",this.lastResume=0,this.changedEntities=[],this.resourceParser=new $YB.utils.ResourceParser(this),this.comm=new $YB.comm.Communication(this.infoManager.options.service,this.infoManager.options.httpSecure),this.comm.requestData(this.infoManager.getDataParams(),function(){t.timer.pinger.interval=Math.max(1e3,1e3*t.comm.pingTime)})},$YB.managers.View.prototype.sendRequest=function(e,t,i){try{this.isAllowed(e)&&this.comm.sendRequest(e,t,i)}catch(r){$YB.error(r)}},$YB.managers.View.prototype.isAllowed=function(e){return this.infoManager.options.enableAnalytics&&!(e in this.infoManager.options.disabledRequests)},$YB.managers.View.prototype.isHalted=function(){return this.infoManager.options.haltOnError&&this.isErrorSent},$YB.managers.View.prototype.sendAdInit=function(e,t){try{this.isHalted()||this.isAdStartSent||this.isAdInitSent||(this.isShowingAds=!0,this.isAdInitSent=!0,this.chrono.adTotal.start(),this.chrono.adJoinTime.start(),this.sendSeekEnd(),this.sendBufferEnd(),e=this.infoManager.getAdStartParams(e),e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position,!0),this.lastAdPosition=e.position,this.sendRequest("/adInit",e,t),$YB.noticeRequest("Request: NQS /adInit "+e.position+e.number))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendAdStart=function(e,t){try{this.isHalted()||this.isAdStartSent||(this.isShowingAds=!0,this.isAdStartSent=!0,this.isAdInitSent||(this.chrono.adTotal.start(),this.chrono.adJoinTime.start()),this.sendSeekEnd(),this.sendBufferEnd(),e=this.infoManager.getAdStartParams(e),e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position,!this.isAdInitSent),this.lastAdPosition=e.position,this.sendRequest("/adStart",e,t),$YB.noticeRequest("Request: NQS /adStart "+e.position+e.number),this.isAdInitSent&&(this.sendAdJoin(),this.isAdInitSent=!1))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendAdJoin=function(e,t){try{this.isHalted()||this.isAdStartSent&&!this.isAdJoinSent&&(this.isAdJoinSent=!0,(this.enableAdBufferMonitor||this.enableAdSeekMonitor)&&(this.timer.adPlayheadMonitor.start(),this.lastPlayhead=0),e=this.infoManager.getAdJoinParams(e),e.duration="undefined"!=typeof e.duration?e.duration:this.chrono.adJoinTime.getDeltaTime(),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),this.sendRequest("/adJoinTime",e,t),$YB.noticeRequest("Request: NQS /adJoinTime "+e.duration+"ms"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendAdStop=function(e,t){try{if(!this.isHalted()&&(this.isAdStartSent||this.isAdInitSent)){var i=void 0;this.isAdPaused&&(this.chrono.adPause.stop(),i=this.chrono.adPause.getDeltaTime()),this.isAdStartSent=!1,this.isAdJoinSent=!1,this.isAdPaused=!1,this.isAdBuffering=!1,this.isShowingAds=!1,this.isAdInitSent=!1,this.timer.adPlayheadMonitor.stop(),e=this.infoManager.getAdStopParams(e),e.totalDuration="undefined"!=typeof e.totalDuration?e.totalDuration:this.chrono.adTotal.getDeltaTime(),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),i&&(e.pauseDuration=i),e.adPlayhead||delete e.adPlayhead,this.isJoinSent||(this.chrono.joinTime.startTime+=this.chrono.adTotal.getDeltaTime(),this.chrono.joinTime.startTime=Math.min(this.chrono.joinTime.startTime,(new Date).getTime())),this.sendRequest("/adStop",e,t),$YB.noticeRequest("Request: NQS /adStop "+e.totalDuration+"ms")}}catch(r){$YB.error(r)}},$YB.managers.View.prototype.sendAdPause=function(e,t){try{this.isHalted()||this.isAdJoinSent&&!this.isAdPaused&&(this.isAdPaused=!0,this.chrono.adPause.start(),e=this.infoManager.getAdPauseParams(e),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),this.sendRequest("/adPause",e,t),$YB.noticeRequest("Request: NQS /adPause"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendAdResume=function(e,t){try{this.isHalted()||this.isAdJoinSent&&this.isAdPaused&&(this.isAdPaused=!1,this.chrono.adPause.stop(),e=this.infoManager.getAdResumeParams(e),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),e.pauseDuration=this.chrono.adPause.getDeltaTime(),this.sendRequest("/adResume",e,t),$YB.noticeRequest("Request: NQS /adResume"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendAdBufferStart=function(){try{this.isHalted()||this.isAdJoinSent&&!this.isAdBuffering&&(this.isAdBuffering=!0,this.chrono.adBuffer.start(),$YB.noticeRequest("Method: /adBufferStart"))}catch(e){$YB.error(e)}},$YB.managers.View.prototype.sendAdBufferEnd=function(e,t){try{this.isHalted()||this.isAdJoinSent&&this.isAdBuffering&&(this.isAdBuffering=!1,e=this.infoManager.getAdBufferEndParams(e),e.duration="undefined"!=typeof e.duration?e.duration:this.chrono.adBuffer.getDeltaTime(),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),this.sendRequest("/adBufferUnderrun",e,t),$YB.noticeRequest("Request: NQS /adBufferUnderrun "+e.duration+"ms"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendAdError=function(e,t){try{this.isHalted()||(e=this.infoManager.getAdErrorParams(e),"undefined"==typeof e.position&&(this.isAdStartSent?e.position=this.lastAdPosition:e.position=this.infoManager.getAdPosition(),e.number=this.getAdNumber(e.position)),this.sendRequest("/adError",e,t),$YB.noticeRequest("Request: NQS /adError"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendAdClick=function(e,t){try{this.isHalted()||(e=this.infoManager.getAdClickParams(e),e.position="undefined"!=typeof e.position?e.position:this.lastAdPosition,e.number="undefined"!=typeof e.number?e.number:this.getAdNumber(e.position),this.sendRequest("/adClick",e,t),$YB.noticeRequest("Request: NQS /adClick"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.getAdNumber=function(e,t){var i=0;switch(e){case"pre":i=t?++this.adCounter.pre:this.adCounter.pre;break;case"mid":i=t?++this.adCounter.mid:this.adCounter.mid;break;case"post":i=t?++this.adCounter.post:this.adCounter.post;break;default:i=t?++this.adCounter.unknown:this.adCounter.unknown}return i>0?i:1},$YB.managers.View.prototype.resetAdNumbers=function(){this.adCounter={pre:0,mid:0,post:0,unknown:0}},$YB.managers.View.prototype.sendIgnoreAdStart=function(){try{this.isHalted()||this.isStartSent&&!this.isShowingAds&&(this.isShowingAds=!0,this.chrono.adIgnore.start(),this.sendBufferEnd(),this.sendSeekEnd(),$YB.noticeRequest("Method: /genericAdStart"))}catch(e){$YB.error(e)}},$YB.managers.View.prototype.sendIgnoreAdEnd=function(){try{this.isHalted()||this.isStartSent&&this.isShowingAds&&(this.isShowingAds=!1,this.chrono.adIgnore.stop(),this.isJoinSent||(this.chrono.joinTime.startTime+=this.chrono.adIgnore.getDeltaTime(),this.chrono.joinTime.startTime=Math.min(this.chrono.joinTime.startTime,(new Date).getTime())),$YB.noticeRequest("Method: /genericAdEnd "+this.chrono.adIgnore.getDeltaTime()+"ms"))}catch(e){$YB.error(e)}},$YB.managers.View.prototype.sendStart=function(e,t){try{this.isHalted()||this.isStartSent||((this.infoManager.options.parseCDNNodeHost||this.infoManager.options.parseHLS)&&this.resourceParser.init(),this.isStartSent=!0,this.chrono.joinTime.start(),$YB.noticeRequest("Sending pings every "+this.comm.pingTime+"s."),this.timer.pinger.interval=Math.max(1e3,1e3*this.comm.pingTime),this.timer.pinger.start(),e=this.infoManager.getStartParams(e),e.pingTime="undefined"!=typeof e.pingTime?e.pingTime:this.comm.pingTime,this.infoManager.options.parseCDNNodeHost&&(this.nodeHost="undefined"!=typeof e.nodeHost?e.nodeHost:"undefined"!=typeof this.resourceParser.nodeHost?this.resourceParser.nodeHost:"",this.nodeType="undefined"!=typeof e.nodeType?e.nodeType:"undefined"!=typeof this.resourceParser.nodeType?this.resourceParser.nodeType:"",e.nodeHost=this.nodeHost,e.nodeType=this.nodeType),this.comm.nextView(e.live),this.infoManager.options.enableInit?(this.sendRequest("/init",e,t),$YB.noticeRequest("Request: NQS /init "+e.resource),this.isInitSent=!0):(this.sendRequest("/start",e,t),$YB.noticeRequest("Request: NQS /start "+e.resource)),this.lastDuration=e.duration,this.lastRendition=e.rendition)}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendJoin=function(e,t){try{if(!this.isHalted()&&this.isStartSent&&!this.isJoinSent&&!this.isShowingAds){if(this.isInitSent){var i=this.infoManager.getStartParams(void 0);i.pingTime="undefined"!=typeof i.pingTime?i.pingTime:this.comm.pingTime,this.infoManager.options.parseCDNNodeHost&&(i.nodeHost=this.nodeHost,i.nodeType=this.nodeType),this.sendRequest("/start",i,t),$YB.noticeRequest("Request: NQS /start "+i.resource),this.isInitSent=!1}this.isJoinSent=!0,(this.enableBufferMonitor||this.enableSeekMonitor)&&(this.timer.playheadMonitor.start(),this.lastPlayhead=0),e=this.infoManager.getJoinParams(e),e.time="undefined"!=typeof e.time?e.time:this.chrono.joinTime.getDeltaTime(),e.mediaDuration===this.lastDuration&&delete e.mediaDuration,this.sendRequest("/joinTime",e,t),$YB.noticeRequest("Request: NQS /joinTime "+e.time+"ms")}}catch(r){$YB.error(r)}},$YB.managers.View.prototype.sendStop=function(e,t){try{if(!this.isHalted()&&this.isStartSent){var i=void 0;this.isJoinSent&&this.isPaused&&(this.chrono.pause.stop(),i=this.chrono.pause.getDeltaTime()),this.isStartSent=!1,this.isInitSent=!1,this.isPaused=!1,this.isJoinSent=!1,this.isSeeking=!1,this.isBuffering=!1,this.isErrorSent=!1,this.resourceParser.clear(),this.resetAdNumbers(),this.stopTimers(),e=this.infoManager.getStopParams(e),e.diffTime="undefined"!=typeof e.diffTime?e.diffTime:this.timer.pinger.chrono.getDeltaTime(),i&&(e.pauseDuration=i),this.sendRequest("/stop",e,t),$YB.noticeRequest("Request: NQS /stop")}}catch(r){$YB.error(r)}},$YB.managers.View.prototype.sendPause=function(e,t){try{this.isHalted()||this.isJoinSent&&!this.isPaused&&(this.isPaused=!0,this.chrono.pause.start(),e=this.infoManager.getPauseParams(e),this.sendRequest("/pause",e,t),$YB.noticeRequest("Request: NQS /pause"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendResume=function(e,t){try{this.isHalted()||this.isJoinSent&&this.isPaused&&(this.isPaused=!1,this.chrono.pause.stop(),this.lastResume=(new Date).getTime(),e=this.infoManager.getResumeParams(e),e.pauseDuration=this.chrono.pause.getDeltaTime(),this.sendRequest("/resume",e,t),$YB.noticeRequest("Request: NQS /resume"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendBufferStart=function(){try{this.isHalted()||this.isJoinSent&&!this.isBuffering&&(this.isBuffering=!0,this.chrono.buffer.start(),$YB.noticeRequest("Method: /bufferStart"))}catch(e){$YB.error(e)}},$YB.managers.View.prototype.sendBufferEnd=function(e,t){try{this.isHalted()||this.isJoinSent&&this.isBuffering&&(this.isBuffering=!1,this.lastResume=(new Date).getTime(),e=this.infoManager.getBufferEndParams(e),e.duration="undefined"!=typeof e.duration?e.duration:this.chrono.buffer.getDeltaTime(),this.sendRequest("/bufferUnderrun",e,t),$YB.noticeRequest("Request: NQS /bufferUnderrun "+e.duration+"ms"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendSeekStart=function(){try{this.isHalted()||this.isJoinSent&&!this.isSeeking&&(this.isSeeking=!0,this.chrono.seek.start(),$YB.noticeRequest("Method: /seekStart"))}catch(e){$YB.error(e)}},$YB.managers.View.prototype.sendSeekEnd=function(e,t){try{this.isHalted()||this.isJoinSent&&this.isSeeking&&(this.isSeeking=!1,this.lastResume=(new Date).getTime(),e=this.infoManager.getSeekEndParams(e),e.duration="undefined"!=typeof e.duration?e.duration:this.chrono.seek.getDeltaTime(),this.sendRequest("/seek",e,t),$YB.noticeRequest("Request: NQS /seek "+e.duration+"ms"))}catch(i){$YB.error(i)}},$YB.managers.View.prototype.sendError=function(e,t){try{this.isErrorSent=!0,!this.infoManager.options.parseCDNNodeHost&&!this.infoManager.options.parseHLS||this.resourceParser.realResource||this.resourceParser.init(),this.infoManager.options.haltOnError&&this.stopTimers(),e=this.infoManager.getErrorParams(e),e.pingTime="undefined"!=typeof e.pingTime?e.pingTime:this.comm.pingTime,this.infoManager.options.parseCDNNodeHost&&(e.nodeHost="undefined"!=typeof e.nodeHost?e.nodeHost:"undefined"!=typeof this.resourceParser.nodeHost?this.resourceParser.nodeHost:"",e.nodeType="undefined"!=typeof e.nodeType?e.nodeType:"undefined"!=typeof this.resourceParser.nodeType?this.resourceParser.nodeType:""),this.sendRequest("/error",e,t),$YB.noticeRequest("Request: NQS /error "+e.msg)}catch(i){$YB.error(i)}},$YB.managers.View.prototype.convertBufferToSeek=function(){try{$YB.noticeRequest("Converting buffer to seek"),this.chrono.seek.startTime=this.chrono.buffer.startTime,this.chrono.seek.lastTime=0,this.chrono.buffer.stop(),this.isBuffering=!1,this.isSeeking=!0}catch(e){$YB.error(e)}},$YB.managers.View.monitoringInterval=800,$YB.managers.View.prototype.jumpNextTick=!1,$YB.managers.View.prototype.checkPlayhead=function(){if(this.isJoinSent&&!this.isShowingAds){var e=2*$YB.managers.View.monitoringInterval,t=$YB.managers.View.monitoringInterval/2,i=1.1*$YB.managers.View.monitoringInterval,r=this.infoManager.getPlayhead(),n=1e3*Math.abs(this.lastPlayhead-r);if(n<t){var s=this.lastResume?Math.abs((new Date).getTime()-this.lastResume):0;this.enableBufferMonitor&&(0==s||s>$YB.managers.View.monitoringInterval)&&this.lastPlayhead>0&&!this.isBuffering&&!this.isPaused&&!this.isSeeking&&this.sendBufferStart()}else n>e?this.enableSeekMonitor&&this.lastPlayhead>0&&!this.isSeeking&&(this.isBuffering?this.convertBufferToSeek():this.sendSeekStart()):this.isSeeking?this.sendSeekEnd():this.isBuffering&&this.enableBufferMonitor&&this.chrono.buffer.getDeltaTime(!1)>i&&this.sendBufferEnd();this.lastPlayhead=r}},$YB.managers.View.prototype.checkAdPlayhead=function(){if(this.isAdJoinSent){var e=$YB.managers.View.monitoringInterval/2,t=1.1*$YB.managers.View.monitoringInterval,i=this.infoManager.getAdPlayhead(),r=1e3*Math.abs(this.lastPlayhead-i);r<e?this.enableAdBufferMonitor&&this.lastPlayhead>0&&!this.isAdBuffering&&!this.isAdPaused&&this.sendAdBufferStart():this.isAdBuffering&&this.chrono.adBuffer.getDeltaTime(!1)>t&&this.sendAdBufferEnd(),this.lastPlayhead=i}},$YB.managers.View.prototype.stopTimers=function(){this.timer.pinger.stop(),this.timer.playheadMonitor.stop(),this.timer.adPlayheadMonitor.stop()},$YB.managers.View.prototype.sendPing=function(e,t){try{e=this.infoManager.getPingParams(e),this.isShowingAds&&(e=this.infoManager.getAdPingParams(e)),e.pingTime="undefined"!=typeof e.pingTime?e.pingTime:this.comm.pingTime,this.isSeeking&&(e.seekDuration="undefined"!=typeof e.seekDuration?e.seekDuration:this.chrono.seek.getDeltaTime(!1)),this.isBuffering&&(e.bufferDuration="undefined"!=typeof e.bufferDuration?e.bufferDuration:this.chrono.buffer.getDeltaTime(!1)),this.isAdBuffering&&(e.adBufferDuration="undefined"!=typeof e.adBufferDuration?e.adBufferDuration:this.chrono.adBuffer.getDeltaTime(!1));var i=this.infoManager.getRendition();if(i&&this.lastRendition!=i&&(this.sendChangedEntity("rendition",i),this.lastRendition=i),this.isAdPaused?e.pauseDuration=this.chrono.adPause.getDeltaTime(!1):this.isJoinSent&&this.isPaused&&(e.pauseDuration=this.chrono.pause.getDeltaTime(!1)),1==this.changedEntities.length){var r=this.changedEntities.shift();e.entityType=r.key,e.entityValue=r.value}else if(this.changedEntities.length>1){e.entityType=null,e.entityValue=null,e.entities={};for(var n=0;n<this.changedEntities.length;n++)e.entities[this.changedEntities[n].key]=this.changedEntities[n].value;this.changedEntities=[]}this.sendRequest("/ping",e,t)}catch(s){$YB.error(s)}},$YB.managers.View.prototype.sendChangedEntity=function(e,t){try{this.changedEntities.push({key:e,value:t})}catch(i){$YB.error(i)}},"undefined"!=typeof module&&module.exports?module.exports=$YB:window.$YB=$YB;